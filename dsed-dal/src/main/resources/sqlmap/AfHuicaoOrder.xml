<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfHuicaoOrderDao">
	<sql id="queryFields">
		id,gmt_create,gmt_modified,order_no,pay_type,status,user_id,wx_zfb,third_order_no
	</sql>


	<insert id="addHuicaoOrder" parameterType="AfHuicaoOrderDo" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO af_huicao_order(gmt_create , gmt_modified , order_no , pay_type , status , user_id,wx_zfb,third_order_no)
		VALUES (
    		NOW(),
    		NOW(),
    		#{orderNo},
    		#{payType},
    		#{status},
    		#{userId},
    		#{wxZfb},
    		#{thirdOrderNo}
		)
	</insert>

	<update id="updateOrderStatus">
		update af_huicao_order set status = #{status},gmt_modified = NOW() where id =#{id}
	</update>

	<update id="updateHuicaoOrderStatusByOrderNo">
		update af_huicao_order set status = #{status},gmt_modified = NOW() where order_no =#{orderNo}
	</update>

	<update id="updateHuicaoOrderStatusLock">
		update af_huicao_order set status = #{status},gmt_modified = NOW() where id =#{id}  and gmt_modified =#{gmtModified}
	</update>


	<select id="getOrderByOrderNo" resultType="AfHuicaoOrderDo">
		select <include refid="queryFields"/> from  af_huicao_order  where order_no =#{orderNo}
	</select>

	<select id="getHuicaoOrderByThirdOrderNo" resultType="AfHuicaoOrderDo">
		select <include refid="queryFields"/> from  af_huicao_order  where third_order_no =#{thirdNo}
	</select>


	<select id="getUnFinishOrder" resultType="AfHuicaoOrderDo">
		select <include refid="queryFields"/> from  af_huicao_order  where user_id =#{userId} and pay_type =#{payType} and (status =0 or status =3)
	</select>

	<select id="getHuicaoUnFinishOrderAll" resultType="AfHuicaoOrderDo">
		select <include refid="queryFields"/> from  af_huicao_order  where  status =0 or status =3
	</select>


</mapper>