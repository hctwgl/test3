<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfResourceDao">
	<sql id="queryAllFields">
		id rid,gmt_create,gmt_modified,creator,modifier,data_type,`type`,type_desc,`name`,`value`,description,
		sec_type,value_1,value_2,value_3,value_4,value_5,sort,pic1,pic2
	</sql>
	<sql id="queryManyAllFields">

		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r1.type_desc,r1.name,r1.value,r1.description,
		r2.sec_type,r1.value_1,r1.value_2,r1.value_3,r2.value_4,r2.value_5,r1.sort
	</sql>
	<sql id="queryManyAllFieldsOneTwo">
		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r2.type_desc,r1.name,r2.value,r1.description,
		r2.sec_type,r2.value_1,r2.value_2,r2.value_3,r2.value_4,r2.value_5,r1.sort
	</sql>
	<sql id="queryManyAllFieldsTwo">
		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r1.type_desc,r1.name,r1.value,r1.description,
		r1.sec_type,r1.value_1,r1.value_2,r1.value_3,r1.value_4,r1.value_5,r1.sort
	</sql>
	<select id="selectHomeConfigByAllTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		type in
		('HOME_BANNER','HOME_TOOLS','HOME_COUPON','HOME_ONE_TO_MANY','HOME_ONE_TO_TWO','HOME_ONE_TO_ONE')
	</select>


	<select id="getConfigByTypeList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM af_resource
		WHERE
		is_delete = 0 AND type IN
		<foreach collection="typeList" item="item" open="(" close=")"
			separator=",">
			#{item}
		</foreach>
	</select>


	<select id="getConfigByTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		type = #{type} ORDER BY sort DESC
	</select>
	<select id="getConfigByTypesAndSecType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type =
		#{secType}
		LIMIT 1

	</select>
	<select id="getResourceByResourceId" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND id = #{rid}
		LIMIT 1

	</select>
	<select id="getOpenBoluomeCouponById" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM af_resource
		WHERE is_delete = 0
		AND value_4 = 'O'
		AND value_2 > NOW()
		AND id = #{rid}
		LIMIT 1
	</select>


	<select id="getResourceListByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type} AND is_delete = 0
	</select>

	<select id="getResourceListByTypeOrderBy" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type} AND value_4 = 'O' AND is_delete = 0
		order by sort desc
	</select>

	<select id="getResourceHomeListByTypeOrderBy" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND value_4 = 'O'
		AND is_delete = 0
		order by
		sort desc
	</select>
	
	<select id="getResourceHomeListByTypeOrderByOnPreEnv" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		order by
		sort desc
	</select>

	<select id="getSingleResourceBytype" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		LIMIT 1
	</select>
	
	<select id="getLaunchImageInfoByTypeAndVersion" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		AND value = 'PART'
		AND   #{version} >= value_1
		AND value_2 >= #{version}
		AND value_4 = 'O'
		order by gmt_create desc
		LIMIT 1
	</select>
	
	<select id="getLaunchImageInfoByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		AND value = 'ALL'
		AND value_4 = 'O'
		order by gmt_create desc
		LIMIT 1
	</select>

	<select id="getHomeIndexListByOrderby" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		order by
		sort DESC
	</select>

	<select id="getOneToManyResourceOrderByBytype" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsOneTwo" />
		FROM
		af_resource r1 LEFT JOIN af_resource r2
		ON r1.id = r2.value_4
		WHERE
		r1.type = #{type}
		AND r1.sec_type = ''
		AND r2.value_4 !=''
		AND r1.is_delete =0
		AND r2.is_delete =0
		AND r1.value_4 = 'O'
		ORDER BY
		r1.sort ,r1.id , r2.sort
	</select>
	
	<select id="getOneToManyResourceOrderByBytypeOnPreEnv" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFields" />
		FROM
		af_resource r1 LEFT JOIN af_resource r2
		ON r1.id = r2.value_4
		WHERE
		r1.type = #{type}
		AND r1.sec_type = ''
		AND r2.value_4 !=''
		AND r1.is_delete =0
		AND r2.is_delete =0
	<!-- 	AND r1.value_4 = 'O' -->
		ORDER BY
		r1.sort ,r1.id , r2.sort
	</select>
	
	<select id="getCarouselToManyResourceOrderByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo" />
		FROM
		af_resource r1
		LEFT JOIN
		af_resource r2
		ON r1.value_4=r2.id
		where
		r1.type= #{type} and r2.value_4='O' and r2.type is not null and r1.is_delete=0
		ORDER BY
		r1.sort ,r1.id
	</select>

	<select id="getManyPricutresResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo" />
		FROM
		af_resource r1
		LEFT JOIN
		af_resource r2
		ON r1.value_4=r2.id
		where
		r1.type= #{type} and r2.value_4='O' and r2.type is not null and r1.is_delete=0
		ORDER BY
		r1.sort ,r1.id
	</select>

	<select id="getNavigationUpOneResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND
		is_delete = 0
		AND value_4 = 'O'
		ORDER BY
		sort
	</select>

	<select id="getNavigationDownTwoResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND
		is_delete = 0
		AND value_4 = 'C'
		ORDER BY
		sort
	</select>
	
	<select id="selectBorrowHomeConfigByAllTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		( (
		type ='BORROW_RATE'
		AND
		sec_type in
		('BASE_BANK_RATE','BORROW_CASH_RANGE','BORROW_CASH_BASE_BANK_DOUBLE','BORROW_CASH_POUNDAGE','BORROW_CASH_OVERDUE_POUNDAGE','BORROW_CASH_LENDER','BORROW_CASH_SUPUER_SWITCH','BORROW_CASH_TOTAL_SWITCH','BORROW_CASH_SHOW_NUM','BORROW_CASH_LENDER_FOR_CASH')
		)Or type ='BORROW_CASH_DAY_NEW')

	</select>

	<select id="newSelectBorrowHomeConfigByAllTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		type ='BORROW_RATE'
		AND
		sec_type in
		('BORROW_CASH_INFO_LEGAL_NEW','BASE_BANK_RATE','BORROW_CASH_RANGE','BORROW_CASH_BASE_BANK_DOUBLE','BORROW_CASH_POUNDAGE','BORROW_CASH_OVERDUE_POUNDAGE','BORROW_CASH_LENDER','BORROW_CASH_SUPUER_SWITCH','BORROW_CASH_TOTAL_SWITCH','BORROW_CASH_SHOW_NUM','BORROW_CASH_LENDER_FOR_CASH','BORROW_RECYCLE_INFO_LEGAL_NEW')


	</select>

	<select id = "selectActivityConfig" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'ACTIVITY_SIGNIN'
		<![CDATA[
		AND  DATE_FORMAT(value_1,'%Y-%m-%d') <= DATE_FORMAT(NOW(),'%Y-%m-%d')
		AND DATE_FORMAT(value_2,'%Y-%m-%d') >= DATE_FORMAT(NOW(),'%Y-%m-%d')	
		]]>	
	</select>
	<select id = "getScrollbarByType" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'BORROW_TOP_SCROLLBAR'
		AND value_4 = 'O'
	</select>
	<select id = "getFakePersonByActivityId" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'GG_FAKE_PERSON'
		AND value = #{activityId}
	</select>

	<select id = "getGGSpecificBanner" resultType = "AfResourceDo">
		SELECT
			*
		FROM
			af_resource
		WHERE
			type = 'GG_TOP_BANNER'
		AND is_delete = 0
		AND value_4 ='O'
		AND value_2 = #{value2};
	</select>
	
	<select id="getActivieResourceByType" resultType = "AfResourceDo">
		select
		<include refid="queryAllFields" />
		from af_resource WHERE type = #{type} and is_delete = 0 ORDER BY sort asc
	</select>
	<select id="getConfigsByTypesAndSecType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = #{secType}
		and value_4 ='O';
	</select>

	<select id="getBackGroundByType" resultType="AfResourceDo">
		SELECT
		name,value,value_1,value_3,sort
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = '1'
	</select>
	<select id="getBackGroundByTypeAndStatusOrder" resultType="AfResourceDo">
		SELECT
		name,value,sec_type,value_1,value_3,sort,value_4
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} 
		and value_4 = 1
		order by  id desc
	</select>
	<select id="getBackGroundByTypeOrder" resultType="AfResourceDo">
		SELECT
		name,value,sec_type,value_1,value_3,sort
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} 
		order by  id desc
	</select>
	<select id="getActivityRule" resultType="String">
		SELECT value from
		af_resource where is_delete = 0 and type =#{type}
	</select>

	<select id="getEcommercePositionUpRescoure" resultType="AfResourceDo">
	
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_IMAGE_ECOMMERCE_POSITION'
		AND
		r1.value_3
		IN
		('HOME_IMAGE_ECOMMERCE_POSITION_LEFT_UP','HOME_IMAGE_ECOMMERCE_POSITION_RIGHT_UP','HOME_IMAGE_ECOMMERCE_POSITION_MID_MID','HOME_IMAGE_ECOMMERCE_POSITION_LEFT_MID')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
	</select>

	<select id="getEcommercePositionDownRescoure" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_IMAGE_ECOMMERCE_POSITION'
		AND
		r1.value_3
		IN
		('HOME_IMAGE_ECOMMERCE_POSITION_LEFT_DOWN','HOME_IMAGE_ECOMMERCE_POSITION_MID_DOWN','HOME_IMAGE_ECOMMERCE_POSITION_RIGHT_DOWN')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
	</select>

	<select id="getEcommerceFloorImgRes" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_ONE_IMAGE_ECOMMERCE'
		AND
		r1.value_3 = 'ONE_IMAGE_ECOMMERCE_ONE'
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		LIMIT 1
	</select>
	
	<select id="getFinancialEntranceInfo" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_ONE_IMAGE_FINANCIAL'
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		LIMIT 1
	</select>
	

	<select id="getBrandFloorImgRes" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_ONE_IMAGE_BRAND'
		AND
		r1.value_3 = 'ONE_IMAGE_BRAND_ONE'
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		LIMIT 1
	</select>
	
	<select id="getHomeNomalPositionList" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_FOUR_IMAGE_NOMAL_POSITION'
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
	</select>
	
	<select id="getHomeBrandPositonInfoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_FOUR_IMAGE_BRAND_POSITION'
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
	</select>
	

	<select id="getScrollbarListByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type} AND is_delete = 0 and value_4 ='O'
	</select>

	<select id="getConfigByTypesAndValue" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND  value= #{value}
		LIMIT 1
	</select>
	
	<update id="editResource" parameterType="AfResourceDo">
		UPDATE af_resource SET gmt_modified = NOW()
			<if test="modifier != null">
    			,modifier=#{modifier}
			</if>
			<if test="dataType != null">
    			,data_type=#{dataType}
			</if>
			<if test="type != null">
    			,type=#{type}
			</if>
			<if test="typeDesc != null">
    			,type_desc=#{typeDesc}
			</if>
			<if test="name != null">
    			,name=#{name}
			</if>
			<if test="value != null">
    			,value=#{value}
			</if>
			<if test="description != null">
    			,description=#{description}
			</if>
			<if test="secType != null">
    			,sec_type=#{secType}
			</if>
			<if test="value1 != null">
    			,value_1=#{value1}
			</if>
			<if test="value2 != null">
    			,value_2=#{value2}
			</if>
			<if test="value3 != null">
    			,value_3=#{value3}
			</if>
			<if test="value4 != null">
    			,value_4=#{value4}
			</if>
			<if test="sort != null">
    			,sort=#{sort}
			</if>
			<if test="pic1 != null">
    			,pic1=#{pic1}
			</if>
			<if test="pic2 != null">
    			,pic2=#{pic2}
			</if>
		WHERE id = #{rid}
	</update>
	

	<select id="getConfigsListByTypesAndSecType" resultType="AfResourceDo">
	SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = #{secType}
	</select>

<!-- 根据类型获取单个配置信息 -->
	<select id="getConfigByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type}
		ORDER BY id DESC
		LIMIT 1
	</select>
	
	<select id="getFlowFlayerResourceConfig" resultType="AfResourceDo">
		SELECT
			a.*
		FROM
			af_resource a
		INNER JOIN af_resource b on b.id = a.value_4 AND b.value_4 = 'O'
		WHERE
			a.type = #{type}
		AND a.sec_type = #{secType};
	</select>


	<!-- 获取新的专场信息(未出账单列表页|已出账单列表页) -->
	<select id="getNewSpecialResource" resultType="AfResourceDo">
		SELECT
			a.*
		FROM
			af_resource a
		INNER JOIN af_resource b on b.id = a.value_4 AND b.value_4 = 'O'
		WHERE
		    a.is_delete = 0 AND
            b.is_delete = 0 AND
			a.type = #{type}
	</select>
	<select id="getGridViewInfoUpList" resultType="AfResourceDo">
	
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'MANEY_PICUTRES_ASJ'
		AND
		r1.value_3
		IN
		('NINE_UPPER_TOP_IMAGE','NINE_UPPER_ONE_IMAGE','NINE_UPPER_TWO_IMAGE')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		ORDER BY  r1.sort ASC
	</select>
	
	<select id="getGridViewInfoCenterList" resultType="AfResourceDo">
	
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'MANEY_PICUTRES_ASJ'
		AND
		r1.value_3
		IN
		('NINE_CENTER_ONE_IMAGE','NINE_CENTER_TWO_IMAGE','NINE_CENTER_THREE_IMAGE')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		ORDER BY  r1.sort ASC
	</select>
	<select id="getGridViewInfoDownList" resultType="AfResourceDo">
	
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'MANEY_PICUTRES_ASJ'
		AND
		r1.value_3
		IN
		('NINE_UP_ONE_IMAGE','NINE_UP_TWO_IMAGE','NINE_UP_THREE_IMAGE')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		ORDER BY  r1.sort ASC
	</select>
	
	<select id="getEcommercePositionUp" resultType="AfResourceDo">
	
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_IMAGE_ECOMMERCE_POSITION_ASJ'
		AND
		r1.value_3
		IN
		('HOME_IMAGE_ECOMMERCE_POSITION_LEFT_UP','HOME_IMAGE_ECOMMERCE_POSITION_RIGHT_UP_ONE','HOME_IMAGE_ECOMMERCE_POSITION_RIGHT_UP_TWO')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
			ORDER BY  r1.sort ASC
	</select>
	<select id="getEcommercePositionDown" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo"></include>
		FROM
		af_resource r1
		LEFT JOIN af_resource r2
		ON r1.value_4 = r2.id
		WHERE
		r1.type = 'HOME_IMAGE_ECOMMERCE_POSITION_ASJ'
		AND
		r1.value_3
		IN
		('HOME_IMAGE_ECOMMERCE_POSITION_LEFT_DOWN','HOME_IMAGE_ECOMMERCE_POSITION_MID_DOWN','HOME_IMAGE_ECOMMERCE_POSITION_RIGHT_DOWN')
		AND r1.is_delete = 0
		AND r2.is_delete = 0
		AND r2.value_4 = 'O'
		ORDER BY  r1.sort ASC
	</select>
</mapper>
