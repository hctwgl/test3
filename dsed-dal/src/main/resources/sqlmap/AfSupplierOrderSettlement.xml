<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfSupplierOrderSettlementDao">

	<!-- 通过id修改结算单打款状态 -->
	<update id="updateSettlementOrderPayStatus" parameterType="AfSupplierOrderSettlementDo">
		UPDATE af_shop_sup_settle_order_result
		SET gmt_modified = now(),
		finish_date = now(),
		`status` = #{status},
		 ups_response = #{upsResponse}
		WHERE id = #{rid}
	</update>

	<!-- 通过settlement_no修改结算单打款状态 -->
	<update id="updateSettlementOrderPayStatusBySettleNo" parameterType="AfSupplierOrderSettlementDo">
		UPDATE af_shop_sup_settle_order_result
		SET gmt_modified = now(),
		finish_date = now(),
		`status` = #{status}
		WHERE settlement_no = #{settlementNo}
	</update>

	<!-- 批量修改结算订单 结算状态 weiqingeng -->
	<update id="updateBatchOrderSettlementStatus" parameterType="AfSupplierOrderSettlementDo">
		UPDATE
		af_shop_sup_settle_order
		SET gmt_modified = NOW(),
		`status` = #{status}
		WHERE result_id = #{rid}
	</update>

	<!-- 根据id查找结算单 -->
	<select id="selectSettlementNoById" parameterType="java.lang.Long" resultType="java.lang.String">
		SELECT offset_settlement_no FROM af_shop_sup_settle_order_result
		WHERE is_delete = 0 AND id = #{rid}
	</select>

	<!-- 根据SettleNo查找结算单 -->
	<select id="selectSettlementNoBySettleNo" parameterType="java.lang.String" resultType="java.lang.Long">
		SELECT id rid FROM af_shop_sup_settle_order_result
		WHERE is_delete = 0 AND settlement_no = #{settlementNo}
	</select>


	<!-- 修改结算订单 结算状态为待打款 hqj -->
	<update id="updateStatusByOrderId" parameterType="java.lang.Long">
		UPDATE
		af_shop_sup_settle_order
		SET gmt_modified = NOW(),
		`status` = 0
		WHERE order_id = #{rid} AND order_status=2
	</update>
	
</mapper>