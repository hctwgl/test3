<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- af_resource_h5_item表:用户菠萝觅优惠券模块 -->
<mapper namespace="com.ald.fanbei.api.dal.dao.AfResourceH5ItemDao">
    
    <!--基本的sql查询字段 公共引用...-->
    <sql id="queryFields">
      id rid,gmt_create,gmt_modified,creator,modifier,model_id,value1,value2,value3,value4,sort
    </sql>
    
    <select id="selectByModelId" resultType="AfResourceH5ItemDto">
        SELECT
          <include refid="queryFields"/>
        FROM
          af_resource_h5_item
        WHERE is_delete = 0
        AND model_id = #{modelId}
        order by sort desc
    </select>

     <select id="getByTagAndType" resultType="AfResourceH5ItemDo">
        SELECT
            i.id rid,i.model_id,i.value1,i.value2,i.value3,i.value4,i.sort
        FROM
          af_resource_h5_item i
          join af_resource_h5  r on r.id = i.model_id
        WHERE i.is_delete = 0
	        AND   r.is_delete = 0
	         and   r.status = 0
	        AND   r.tag   = #{tag}
	        AND   i.value2 = #{type}
	        limit 1
    </select>
     <select id="getByTag" resultType="AfResourceH5ItemDo">
        SELECT
         i.id rid,i.model_id,i.value1,i.value2,i.value3,i.value4,i.sort
         FROM
          af_resource_h5_item i
          join af_resource_h5  r on r.id = i.model_id
        WHERE i.is_delete = 0
          	 and   r.status = 0
	        AND   r.is_delete = 0
	        AND   r.tag   = #{tag}
        order by i.sort desc
    </select>
    


    <select id="findListByModelTagAndSort" resultType="AfResourceH5ItemDto">
        SELECT hi.id, hi.value1, hi.value2, hi.value3, hi.value4, hi.sort
        FROM af_resource_h5_item hi, af_resource_h5 h
        WHERE hi.model_id = h.id AND hi.is_delete = 0 AND h.is_delete = 0 AND h.tag = #{tag} AND h.sort = #{sort}
        ORDER BY hi.sort DESC
    </select>
     
       <select id="getByTagAndValue2" resultType="AfResourceH5ItemDto">
          SELECT
              i.id rid,i.model_id,i.value1,i.value2,i.value3,i.value4,i.sort
         FROM
          af_resource_h5_item i
          join af_resource_h5  r on r.id = i.model_id
          WHERE i.is_delete = 0
          and   r.is_delete = 0
          and   r.status = 0
          and   r.tag = #{tag}
          and   i.value2 =#{type}
          order by sort desc
       </select>

</mapper>
