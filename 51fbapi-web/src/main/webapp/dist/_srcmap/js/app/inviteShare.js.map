{"version":3,"sources":["js/app/inviteShare.js"],"names":["formatDateTime","date","Date","y","getFullYear","m","getMonth","d","getDate","getHours","getMinutes","getSeconds","timerS","$","clearInterval","timerInterval","text","recommendCode","getUrl","token","Math","random","toString","substr","_fmOpt","partner","appName","cimg","Image","imgLoaded","fm","document","createElement","location","src","protocol","async","getElementsByTagName","s","insertBefore","getTime","toFixed","parentNode","methods","getCode","mobileNum","this","attr","val","isNaN","test","ajax","url","type","dataType","data","mobile","beforeSend","console","log","ok","success","returnData","setInterval","timeFunction","removeAttr","requestMsg","goRegister","pwdMd5","String","length","pwdReg","CryptoJS","MD5","VerifiCode","telNum","pwdLength","registerMobile","smsCode","href","msg"],"mappings":"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","file":"../../../js/app/inviteShare.js","sourcesContent":["\n\n// 从分享链接中获取code\nvar recommendCode = getUrl(\"recommendCode\");\n\nvar token=formatDateTime()+Math.random().toString(36).substr(2);\n\n// 防止风控被拒\nfunction formatDateTime() {\n    var date = new Date();\n    var y = date.getFullYear();\n    var m = date.getMonth() + 1;\n    m = m < 10 ? ('0' + m) : m;\n    var d = date.getDate();\n    d = d < 10 ? ('0' + d) : d;\n    var h = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n    return y +  m +  d +h +minute+second;\n};\n\n\n// 同盾校验编号的sessionId\nvar _fmOpt;\n(function() {\n    _fmOpt = {\n        partner: 'alading',\n        appName: 'alading_web',\n        token: token\n    };\n    var cimg = new Image(1,1);\n    cimg.onload = function() {\n        _fmOpt.imgLoaded = true;\n    };\n    cimg.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +\"fp.fraudmetrix.cn/fp/clear.png?partnerCode=alading&appName=alading_web&tokenId=\" + _fmOpt.token;\n    var fm = document.createElement('script'); fm.type = 'text/javascript'; fm.async = true;\n    fm.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'static.fraudmetrix.cn/fm.js?ver=0.1&t=' + (new Date().getTime()/3600000).toFixed(0);\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(fm, s);\n    // alert(json.msg);\n})();\n\n\n\nvar timerInterval ;\nvar timerS = 60;\nfunction timeFunction(){ // 60s倒计时\n    timerS--;\n    if (timerS<=0) {\n        $(\"#codeBtn\").removeAttr(\"disabled\");\n        $(\"#codeBtn\").text(\"获取验证码\");\n        clearInterval(timerInterval);\n        timerS = 60;\n    } else {\n        $(\"#codeBtn\").text(timerS+\" s\");\n    }\n};\n\nvar vm=new Vue({\n    el: '#inviteShare',\n    methods:{\n        getCode(){\n            var isState = $(this).attr(\"isState\");\n            var mobileNum = $(\"#tel\").val();\n\n            if ( !isNaN(mobileNum) && (/^1(3|4|5|7|8)\\d{9}$/i.test(mobileNum)) ){  // 验证码不能为空、判断电话开头\n                $(\"#codeBtn\").attr(\"disabled\",true);\n                $.ajax({\n                    url: \"/app/user/getRegisterSmsCode\",\n                    type: \"POST\",\n                    dataType: \"JSON\",\n                    data: {\n                        mobile: mobileNum,\n                    },\n                    beforeSend: function(){\n                        // $(\"#codeBtn\").attr(\"isState\",1);\n                        // $(\"#codeBtn\").text(timerS+\" s\");\n                        // timerInterval = setInterval(timeFunction,1000);\n                        console.log(ok);\n                    },\n                    success: function(returnData){\n                        if (returnData.success) {\n                            console.log(returnData);\n                            $(\"#codeBtn\").attr(\"isState\",1);\n                            $(\"#codeBtn\").text(timerS+\" s\");\n                            timerInterval = setInterval(timeFunction,1000);\n                        } else {\n                            requestMsg(returnData.msg);\n                            $(\"#codeBtn\").removeAttr(\"disabled\");\n                        }\n                    },\n                    error: function(){\n                        requestMsg(\"请求失败\");\n                    }\n                })\n            } else{\n                requestMsg(\"请填写正确的手机号\");\n            }\n        },\n        goRegister(){\n\n            var pwdLength = ($(\"#password\").val()).length;\n            var pwdMd5 = String(CryptoJS.MD5($(\"#password\").val())); // md5加密\n            var pwdReg=(/^((?=.*?\\d)(?=.*?[A-Za-z])|(?=.*?\\d)(?=.*?[.!@#$%])|(?=.*?[A-Za-z])(?=.*?[.]))[\\dA-Za-z.!@#$%]+$/).test($(\"#password\").val()); // 正则判断密码为6-18位字母+字符的组合\n\n            var telNum = $(\"#tel\").val();\n            var VerifiCode = $(\"#VerifiCode\").val();\n\n            var isState = $(\"#register_codeBtn\").attr(\"isState\");\n\n            if(/^1(3|4|5|7|8)\\d{9}$/i.test(telNum) && telNum != \"\" ){ // 判断电话开头\n                if ( VerifiCode != \"\" ) { // 验证码不能为空\n                    if ( pwdReg && 6 <= pwdLength && pwdLength <= 18 ) { // 密码6-18位\n                        if ($(\"#inputCheck\").is(\":checked\")) { // 判断当前是否选中\n                            if ( $(\"#codeBtn\").attr(\"isState\")==1 ) {\n\n                                $.ajax({ // 设置登录密码\n                                    url: \"/app/user/commitRegister\",\n                                    type: 'POST',\n                                    dataType: 'JSON',\n                                    data: {\n                                        registerMobile: telNum,\n                                        smsCode: VerifiCode,\n                                        password: pwdMd5,\n                                        recommendCode: recommendCode,\n                                        token: token\n                                    },\n                                    success: function(returnData){\n                                        if ( returnData.success ) {\n                                            $(\"#register_submitBtn\").attr(\"disabled\",true);\n                                            window.location.href = returnData.url;\n                                        } else {\n                                            requestMsg(returnData.msg);\n                                        }\n                                    },\n                                    error: function(){\n                                        requestMsg(\"注册失败\");\n                                    }\n                                })\n                            } else {\n                                requestMsg(\"请获取验证码\");\n                            }\n                        } else {\n                            requestMsg(\"请阅读并同意《51返呗用户注册协议》\");\n                        }\n                    }else{\n                        requestMsg(\"请填写6-18位的数字、字母、字符组成的密码\");\n                    }\n                } else {\n                    requestMsg(\"请输入正确的验证码\");\n                }\n            } else{\n                requestMsg(\"请填写正确的手机号\");\n            };\n        }\n    }\n});"]}