{"version":3,"sources":["js/app/inviteShare.js"],"names":["formatDateTime","date","Date","y","getFullYear","m","getMonth","d","getDate","getHours","getMinutes","getSeconds","timerS","$","text","clearInterval","timerInterval","recommendCode","getUrl","token","Math","random","toString","substr","_fmOpt","partner","appName","cimg","Image","onload","imgLoaded","src","document","location","protocol","fm","createElement","type","async","getTime","toFixed","s","getElementsByTagName","parentNode","insertBefore","el","Vue","methods","getCode","mobileNum","attr","val","isNaN","test","ajax","url","dataType","data","mobile","beforeSend","console","log","ok","success","returnData","setInterval","timeFunction","requestMsg","msg","removeAttr","error","goRegister","pwdLength","length","pwdMd5","String","CryptoJS","MD5","pwdReg","telNum","VerifiCode","is","registerMobile","password","window","href"],"mappings":"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","file":"../../../js/app/inviteShare.js","sourcesContent":["\n\n// 从分享链接中获取code\nvar recommendCode = getUrl(\"recommendCode\");\n\n// 防止风控被拒\nfunction formatDateTime() {\n    var date = new Date();\n    var y = date.getFullYear();\n    var m = date.getMonth() + 1;\n    m = m < 10 ? ('0' + m) : m;\n    var d = date.getDate();\n    d = d < 10 ? ('0' + d) : d;\n    var h = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n    return y +  m +  d +h +minute+second;\n};\nvar token=formatDateTime()+Math.random().toString(36).substr(2);\n\n// 同盾校验编号的sessionId\nvar _fmOpt;\n(function() {\n    _fmOpt = {\n        partner: 'alading',\n        appName: 'alading_web',\n        token: token\n    };\n    var cimg = new Image(1,1);\n    cimg.onload = function() {\n        _fmOpt.imgLoaded = true;\n    };\n    cimg.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +\"fp.fraudmetrix.cn/fp/clear.png?partnerCode=alading&appName=alading_web&tokenId=\" + _fmOpt.token;\n    var fm = document.createElement('script'); fm.type = 'text/javascript'; fm.async = true;\n    fm.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'static.fraudmetrix.cn/fm.js?ver=0.1&t=' + (new Date().getTime()/3600000).toFixed(0);\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(fm, s);\n    // alert(json.msg);\n})();\n\n\n\nvar timerInterval ;\nvar timerS = 60;\nfunction timeFunction(){ // 60s倒计时\n    timerS--;\n    if (timerS<=0) {\n        $(\"#codeBtn\").removeAttr(\"disabled\");\n        $(\"#codeBtn\").text(\"获取验证码\");\n        clearInterval(timerInterval);\n        timerS = 60;\n    } else {\n        $(\"#codeBtn\").text(timerS+\" s\");\n    }\n};\n\nvar vm=new Vue({\n    el: '#inviteShare',\n    methods:{\n        getCode(){\n            var isState = $(this).attr(\"isState\");\n            var mobileNum = $(\"#tel\").val();\n\n            if ( !isNaN(mobileNum) && (/^1(3|4|5|7|8)\\d{9}$/i.test(mobileNum)) ){  // 验证码不能为空、判断电话开头\n                $(\"#codeBtn\").attr(\"disabled\",true);\n                $.ajax({\n                    url: \"/app/user/getRegisterSmsCode\",\n                    type: \"POST\",\n                    dataType: \"JSON\",\n                    data: {\n                        mobile: mobileNum,\n                    },\n                    beforeSend: function(){\n                        // $(\"#codeBtn\").attr(\"isState\",1);\n                        // $(\"#codeBtn\").text(timerS+\" s\");\n                        // timerInterval = setInterval(timeFunction,1000);\n                        console.log(ok);\n                    },\n                    success: function(returnData){\n                        if (returnData.success) {\n                            console.log(returnData);\n                            $(\"#codeBtn\").attr(\"isState\",1);\n                            $(\"#codeBtn\").text(timerS+\" s\");\n                            timerInterval = setInterval(timeFunction,1000);\n                        } else {\n                            requestMsg(returnData.msg);\n                            $(\"#codeBtn\").removeAttr(\"disabled\");\n                        }\n                    },\n                    error: function(){\n                        requestMsg(\"请求失败\");\n                    }\n                })\n            } else{\n                requestMsg(\"请填写正确的手机号\");\n            }\n        },\n        goRegister(){\n\n            var pwdLength = ($(\"#password\").val()).length;\n            var pwdMd5 = String(CryptoJS.MD5($(\"#password\").val())); // md5加密\n            var pwdReg=(/^((?=.*?\\d)(?=.*?[A-Za-z])|(?=.*?\\d)(?=.*?[.!@#$%])|(?=.*?[A-Za-z])(?=.*?[.]))[\\dA-Za-z.!@#$%]+$/).test($(\"#password\").val()); // 正则判断密码为6-18位字母+字符的组合\n\n            var telNum = $(\"#tel\").val();\n            var VerifiCode = $(\"#VerifiCode\").val();\n\n            var isState = $(\"#register_codeBtn\").attr(\"isState\");\n\n            if(/^1(3|4|5|7|8)\\d{9}$/i.test(telNum) && telNum != \"\" ){ // 判断电话开头\n                if ( VerifiCode != \"\" ) { // 验证码不能为空\n                    if ( pwdReg && 6 <= pwdLength && pwdLength <= 18 ) { // 密码6-18位\n                        if ($(\"#inputCheck\").is(\":checked\")) { // 判断当前是否选中\n                            if ( $(\"#codeBtn\").attr(\"isState\")==1 ) {\n\n                                $.ajax({ // 设置登录密码\n                                    url: \"/app/user/commitRegister\",\n                                    type: 'POST',\n                                    dataType: 'JSON',\n                                    data: {\n                                        registerMobile: telNum,\n                                        smsCode: VerifiCode,\n                                        password: pwdMd5,\n                                        recommendCode: recommendCode,\n                                        token: token\n                                    },\n                                    success: function(returnData){\n                                        if ( returnData.success ) {\n                                            $(\"#register_submitBtn\").attr(\"disabled\",true);\n                                            window.location.href = returnData.url;\n                                        } else {\n                                            requestMsg(returnData.msg);\n                                        }\n                                    },\n                                    error: function(){\n                                        requestMsg(\"注册失败\");\n                                    }\n                                })\n                            } else {\n                                requestMsg(\"请获取验证码\");\n                            }\n                        } else {\n                            requestMsg(\"请阅读并同意《51返呗用户注册协议》\");\n                        }\n                    }else{\n                        requestMsg(\"请填写6-18位的数字、字母、字符组成的密码\");\n                    }\n                } else {\n                    requestMsg(\"请输入正确的验证码\");\n                }\n            } else{\n                requestMsg(\"请填写正确的手机号\");\n            };\n        }\n    }\n});"]}