{"version":3,"sources":["js/app/inviteShare.js"],"names":["formatDateTime","date","Date","y","getFullYear","m","getMonth","d","getDate","getHours","getMinutes","getSeconds","timerS","$","text","clearInterval","timerInterval","recommendCode","getUrl","token","Math","random","toString","substr","_fmOpt","partner","appName","cimg","Image","onload","imgLoaded","src","document","location","protocol","fm","createElement","type","async","getTime","toFixed","s","getElementsByTagName","parentNode","insertBefore","el","Vue","methods","getCode","mobileNum","attr","val","isNaN","test","ajax","url","dataType","data","mobile","beforeSend","setInterval","timeFunction","success","returnData","console","log","requestMsg","msg","removeAttr","error","goRegister","pwdLength","length","pwdMd5","String","CryptoJS","MD5","pwdReg","telNum","VerifiCode","is","registerMobile","password","window","href"],"mappings":"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","file":"../../../js/app/inviteShare.js","sourcesContent":["\r\n\r\n// 从分享链接中获取code\r\nvar recommendCode = getUrl(\"recommendCode\");\r\n\r\n// 防止风控被拒\r\nfunction formatDateTime() {\r\n    var date = new Date();\r\n    var y = date.getFullYear();\r\n    var m = date.getMonth() + 1;\r\n    m = m < 10 ? ('0' + m) : m;\r\n    var d = date.getDate();\r\n    d = d < 10 ? ('0' + d) : d;\r\n    var h = date.getHours();\r\n    var minute = date.getMinutes();\r\n    var second = date.getSeconds();\r\n    return y +  m +  d +h +minute+second;\r\n};\r\nvar token=formatDateTime()+Math.random().toString(36).substr(2);\r\n\r\n// 同盾校验编号的sessionId\r\nvar _fmOpt;\r\n(function() {\r\n    _fmOpt = {\r\n        partner: 'alading',\r\n        appName: 'alading_web',\r\n        token: token\r\n    };\r\n    var cimg = new Image(1,1);\r\n    cimg.onload = function() {\r\n        _fmOpt.imgLoaded = true;\r\n    };\r\n    cimg.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +\"fp.fraudmetrix.cn/fp/clear.png?partnerCode=alading&appName=alading_web&tokenId=\" + _fmOpt.token;\r\n    var fm = document.createElement('script'); fm.type = 'text/javascript'; fm.async = true;\r\n    fm.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'static.fraudmetrix.cn/fm.js?ver=0.1&t=' + (new Date().getTime()/3600000).toFixed(0);\r\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(fm, s);\r\n    // alert(json.msg);\r\n})();\r\n\r\n\r\n\r\nvar timerInterval ;\r\nvar timerS = 60;\r\nfunction timeFunction(){ // 60s倒计时\r\n    timerS--;\r\n    if (timerS<=0) {\r\n        $(\"#codeBtn\").removeAttr(\"disabled\");\r\n        $(\"#codeBtn\").text(\"获取验证码\");\r\n        clearInterval(timerInterval);\r\n        timerS = 60;\r\n    } else {\r\n        $(\"#codeBtn\").text(timerS+\" s\");\r\n    }\r\n};\r\n\r\nvar vm=new Vue({\r\n    el: '#inviteShare',\r\n    methods:{\r\n        getCode(){\r\n            var isState = $(this).attr(\"isState\");\r\n            var mobileNum = $(\"#tel\").val();\r\n\r\n            if ( !isNaN(mobileNum) && (/^1(3|4|5|7|8)\\d{9}$/i.test(mobileNum)) ){  // 验证码不能为空、判断电话开头\r\n                $(\"#codeBtn\").attr(\"disabled\",true);\r\n                $.ajax({\r\n                    url: \"/app/user/getRegisterSmsCode\",\r\n                    type: \"POST\",\r\n                    dataType: \"JSON\",\r\n                    data: {\r\n                        mobile: mobileNum,\r\n                    },\r\n                    beforeSend: function(){\r\n                        $(\"#codeBtn\").attr(\"isState\",1);\r\n                        $(\"#codeBtn\").text(timerS+\" s\");\r\n                        timerInterval = setInterval(timeFunction,1000);\r\n                    },\r\n                    success: function(returnData){\r\n                        console.log(returnData);\r\n                        if (returnData.success) {\r\n                            console.log(returnData);\r\n                        } else {\r\n                            requestMsg(returnData.msg);\r\n                            $(\"#codeBtn\").removeAttr(\"disabled\");\r\n                        }\r\n                    },\r\n                    error: function(){\r\n                        requestMsg(\"请求失败\");\r\n                    }\r\n                })\r\n            } else{\r\n                requestMsg(\"请填写正确的手机号\");\r\n            }\r\n        },\r\n        goRegister(){\r\n\r\n            var pwdLength = ($(\"#password\").val()).length;\r\n            var pwdMd5 = String(CryptoJS.MD5($(\"#password\").val())); // md5加密\r\n            var pwdReg=(/^((?=.*?\\d)(?=.*?[A-Za-z])|(?=.*?\\d)(?=.*?[.!@#$%])|(?=.*?[A-Za-z])(?=.*?[.]))[\\dA-Za-z.!@#$%]+$/).test($(\"#password\").val()); // 正则判断密码为6-18位字母+字符的组合\r\n\r\n            var telNum = $(\"#tel\").val();\r\n            var VerifiCode = $(\"#VerifiCode\").val();\r\n\r\n            var isState = $(\"#register_codeBtn\").attr(\"isState\");\r\n\r\n            if(/^1(3|4|5|7|8)\\d{9}$/i.test(telNum) && telNum != \"\" ){ // 判断电话开头\r\n                if ( VerifiCode != \"\" ) { // 验证码不能为空\r\n                    if ( pwdReg && 6 <= pwdLength && pwdLength <= 18 ) { // 密码6-18位\r\n                        if ($(\"#inputCheck\").is(\":checked\")) { // 判断当前是否选中\r\n                            if ( $(\"#codeBtn\").attr(\"isState\")==1 ) {\r\n\r\n                                $.ajax({ // 设置登录密码\r\n                                    url: \"/app/user/commitRegister\",\r\n                                    type: 'POST',\r\n                                    dataType: 'JSON',\r\n                                    data: {\r\n                                        registerMobile: telNum,\r\n                                        smsCode: VerifiCode,\r\n                                        password: pwdMd5,\r\n                                        recommendCode: recommendCode,\r\n                                        token: token\r\n                                    },\r\n                                    success: function(returnData){\r\n                                        if ( returnData.success ) {\r\n                                            $(\"#register_submitBtn\").attr(\"disabled\",true);\r\n                                            window.location.href = returnData.url;\r\n                                        } else {\r\n                                            requestMsg(returnData.msg);\r\n                                        }\r\n                                    },\r\n                                    error: function(){\r\n                                        requestMsg(\"注册失败\");\r\n                                    }\r\n                                })\r\n                            } else {\r\n                                requestMsg(\"请获取验证码\");\r\n                            }\r\n                        } else {\r\n                            requestMsg(\"请阅读并同意《51返呗用户注册协议》\");\r\n                        }\r\n                    }else{\r\n                        requestMsg(\"请填写6-18位的数字、字母、字符组成的密码\");\r\n                    }\r\n                } else {\r\n                    requestMsg(\"请输入正确的验证码\");\r\n                }\r\n            } else{\r\n                requestMsg(\"请填写正确的手机号\");\r\n            };\r\n        }\r\n    }\r\n});"]}