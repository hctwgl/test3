{"version":3,"sources":["activity/06/superGoods.js"],"names":["alaShareData","dataObj","ipUrl","domainName","shareAppTitle","shareAppContent","shareAppImage","shareAppUrl","activityId","isSubmit","sharePage","JSON","stringify","getUrl","vm","Vue","content","this","logData","methods","self","$","ajax","url","type","success","data","diff","showTime","word","time","className","parseInt","currentTime","day","hour","minute","second","floor","Math","html","interval","word01","word02","start","end","setInterval","hide","eval","console","validStartTime","validEndTime","activityGoodsList","i","j","dom","startTime","error","requestMsg","buyNow","id","superGoodsShare","window","href","notifyUrl","str","len","char_length","length","cut_str","charAt","son_str","encodeURI","sub_len"],"mappings":"YAIA,SAAAA,gBAmIYA,GAAAA,GAAAA,aACFC,GACIC,SAAMC,IACNF,KAAU,QACZG,cAAiB,MACjBC,gBAAiB,6CACjBC,cAAiB,2DACjBC,YAAmBL,EAAA,8EAA+CM,WAClEC,SAAA,IACAC,UAAeR,aANjB,OAQeS,MAAAC,UAAaX,GA/InC,GAAIO,YAAaK,OAAO,cACvBC,GAAG,GAAIC,MADJP,GAAAA,cACHM,MACGE,YAECA,QAAAA,WAHOC,KAAAC,WAMPC,SANOD,QAMP,QAAAA,WAGAA,GADIE,MAAAH,IAEAI,GAAAC,MACIF,KAAK,OACFG,IAAA,iCACCC,MAAMhB,WADPA,YAECe,QAAK,QAAAE,SAAAC,MASCC,QAAJC,UAAAC,EAAAC,EAAAC,GACAJ,KAAAK,UAAAF,EAAAG,aAAA,IACE,IAASL,GAAAA,EACAI,EAAAA,EACDE,EAAJ,EACIC,EADJ,CAEIC,OAFJ,IAGIC,EAAAA,KAHJC,MAAAX,KAAAA,OAIGA,EAAHY,KAAaD,MAAAX,KAAAA,MAAA,GAAAO,EACXA,EAAWI,KAALA,MAAWX,KAAQ,IAAzB,GAAmCO,EAAnC,GAAA,GAAAC,EACAA,EAAOI,KAAKD,MAAMX,MAAX,GAAwBO,EAAQA,GAAvC,GAAA,GAAAC,EAAA,GAAA,GAAAC,EACAA,GAAcE,IAAMX,EAAX,IAAyBO,GAClCG,GAAcC,IAAMX,EAASO,IAAAG,GACvBD,EAAAA,IAAAA,GAAaI,KAAAX,EAAA,IAAAK,EAAA,IAAAC,EAAA,IAAAC,EAAA,IAAAC,EAAA,MACwB,QAAAI,UAAAC,EAAAC,EAAAC,EAAAC,EAAAd,GACvCE,YAAIF,EACTH,SAAAc,EAAAE,EAAAb,GAQGH,SAASe,EAAOE,EAAId,EAHTa,aAAM,WACRF,YAATE,GACCA,GAAA,IACQD,SAATD,EAAoBX,EAApBA,KAEUe,GAAAA,IACHb,SAAYW,EAAMC,EAAAd,GACVJ,MAAP,GACSe,EAAAA,IAAOE,GAAMb,SAAtBgB,SAGAnB,KAxCfR,KAACJ,QAAAgC,KAAaxC,IAAdkB,KAHN,KAICD,KAAQT,QAAAI,KAASM,QAAMA,KACrBN,QAAKJ,IAALI,KAAe4B,QACf5B,IAAKJ,aAAeA,KAAAA,QAApBiB,YACAgB,eAAiBjC,KAAjBA,QAAAkC,eACIjB,aAAcb,KAAKJ,QAAQiB,aAC3BiB,KAAAA,CAiDMT,UAAA,QAAA,QAAAS,eAAAC,aAAA,YAKTV,KAAAA,GADEW,mBAAAhC,KAAAJ,QAAAoC,kBACOC,EAAA,EAAAA,EAATD,kBAAyBF,OAAzBG,KAKG,SAAUC,GAHd,GAAAC,GAAA,mBAAAD,CAEQD,YAAMD,WACTX,SAAW,QAAA,QAAAW,kBAAAE,GAAAE,UAAAJ,kBAAAE,GAAAH,aAAAI,IACV,IACAF,IAIDI,MAND,WAOHC,WAAA,YAKFC,OAtFb,SAsFaC,GAhFF,GAAPxC,GAAAH,KAJA4C,EAAAhD,OAAA,kBAwFFiD,QAAI1C,SAAJ2C,KAxFE,mBAAAF,EAwFF,wDAEyBzC,EAAAJ,QAAAgD,UAAmB,uBAAAJ,EAAA,MAGvCE,OA/FP,SA+FOA,GAqBM,MAZJ,UAAAG,EAAAC,GAEJ,IAAA,GADGC,GAAA,EACHd,EAAA,EAAAA,EAAAY,EAAAG,OAAAf,IAAA,CACD,GAASgB,GAAaH,EAAtBI,OAA0BjB,EAEtB,IADIc,UAAAA,GAAJC,OAAA,EAAAD,GAAA,EAAAA,GAAA,GACKA,GAAeF,EAAIG,CAChBG,GAAAA,GAAcD,GAAlBJ,EAAAb,EAAA,EAAAA,CACAmB,OAAUD,GAAAA,OAASH,EAAnBK,MAKCpB,EAAA","file":"../../../activity/06/superGoods.js","sourcesContent":["/**\r\n * Created on 2017/6/20.\r\n */\r\n   var activityId = getUrl(\"activityId\");\r\nlet vm=new Vue({\r\n    el:'#superGoods',\r\n    data:{\r\n        content:{}\r\n    },\r\n    created:function () {\r\n        this.logData();\r\n    },\r\n    methods:{\r\n        logData(){\r\n            //获取页面初始化信息\r\n            let self=this;\r\n            $.ajax({\r\n                    type: 'post',\r\n                    url: '/fanbei-web/encoreActivityInfo',\r\n                    data:{'activityId':activityId},\r\n                    success:function(data) {                      \r\n                      self.content = eval('(' + data + ')');                      \r\n                      self.content = self.content.data;  \r\n                      console.log(self.content)\r\n                      var currentTime = self.content.currentTime;\r\n                      var validStartTime = self.content.validStartTime;\r\n                      var validEndTime = self.content.validEndTime;\r\n                      var diff=0;\r\n                      //活动时间倒计时-----------\r\n                        function showTime(word,time,className){\r\n                            diff=parseInt((time-currentTime)/1000);\r\n                            var day=0,\r\n                                hour=0,\r\n                                minute=0,\r\n                                second=0;                           \r\n                            if(diff > -1){\r\n                              day = Math.floor(diff / (60 * 60 * 24));\r\n                              hour = Math.floor(diff / (60 * 60)) - (day * 24);\r\n                              minute = Math.floor(diff / 60) - (day * 24 * 60) - (hour * 60);\r\n                              second = Math.floor(diff) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);\r\n                                if (minute <= 9) {minute = '0' + minute;}\r\n                                if (second <= 9) {second = '0' + second;}\r\n                                $('.'+className).html(word+'：'+day+'天'+hour+'时'+minute+'分'+second+'秒');\r\n                            }                        \r\n\r\n                        }//------------倒计时\r\n\r\n                        function interval(word01,word02,start,end,className){\r\n                            if(currentTime<start){\r\n                                showTime(word01,start,className);\r\n                            }else{\r\n                                showTime(word02,end,className);\r\n                            }\r\n                                let time1=setInterval(function(){\r\n                                    if(currentTime<start){\r\n                                        start-=1000;\r\n                                        showTime(word01,start,className);\r\n                                    }else{\r\n                                        end-=1000;\r\n                                        showTime(word02,end,className);\r\n                                        if(diff<=0){\r\n                                            $('.'+className).parent().hide()\r\n                                                     }\r\n                                    }\r\n                                }, 1000);\r\n\r\n                                // timer=setInterval(function(){\r\n                                //\r\n                                //     if(diff==0){\r\n                                //         window.clearInterval(timer);\r\n                                //\r\n                                //         self.logData();\r\n                                //     }else{\r\n                                //         end-=1000;\r\n                                //         showTime(word02,end,className);\r\n                                //     }\r\n                                // }, 1000);\r\n\r\n                        }//定时器\r\n                       interval('距活动开始','距活动结束',validStartTime,validEndTime,'countTime');\r\n\r\n                      //商品列表---activityGoodsList\r\n                      var activityGoodsList=self.content.activityGoodsList;                     \r\n                      for(var i=0;i<activityGoodsList.length;i++){\r\n                          (function(j){\r\n                            let dom='productCountTime'+j;\r\n                            //console.log(dom)\r\n                              setTimeout(function timer(){\r\n                              interval('距开始仅剩','距结束仅剩',activityGoodsList[j].startTime,activityGoodsList[j].validEndTime,dom);\r\n                            },0)\r\n                          })(i)   \r\n                      }//商品列表---activityGoodsList---end\r\n\r\n                    }, \r\n                    error:function(){\r\n                       requestMsg(\"请求失败\");\r\n                    }\r\n                });\r\n        },\r\n        buyNow(id){\r\n          let self=this\r\n            var superGoodsShare = getUrl(\"superGoodsShare\");\r\n            if (superGoodsShare == \"superGoodsShare\") {\r\n               window.location.href=\"http://a.app.qq.com/o/simple.jsp?pkgname=com.alfl.www\";\r\n            } else {\r\n               window.location.href=self.content.notifyUrl+'&params={\"goodsId\":\"'+id+'\"}'\r\n            }\r\n        },\r\n        txtFix(i){\r\n            function get_length(s){\r\n                var char_length = 0;\r\n                for (var i = 0; i < s.length; i++){\r\n                    var son_char = s.charAt(i);\r\n                    encodeURI(son_char).length > 2 ? char_length += 1 : char_length += 0.5;\r\n                }\r\n                return char_length;\r\n            }\r\n            function cut_str(str, len){\r\n                var char_length = 0;\r\n                for (var i = 0; i < str.length; i++){\r\n                    var son_str = str.charAt(i);\r\n                    encodeURI(son_str).length > 2 ? char_length += 1 : char_length += 0.5;\r\n                    if (char_length >= len){\r\n                        var sub_len = char_length == len ? i+1 : i;\r\n                        return str.substr(0, sub_len);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return cut_str(i, 20)\r\n        }\r\n        \r\n    }\r\n});\r\n\r\n   function alaShareData(){\r\n          // 分享内容\r\n          var ipUrl=domainName();\r\n          var dataObj = {\r\n            'appLogin': 'N', // 是否需要登录，Y需要，N不需要\r\n            'type': 'share', // 此页面的类型\r\n            'shareAppTitle': '特卖会',  // 分享的title\r\n            'shareAppContent': '51返呗返场加购，精选好货抄低价！爆款精品仅在“特卖会”，拼的就是手速，赶紧来围观~',  // 分享的内容\r\n            'shareAppImage': 'https://fs.51fanbei.com/h5/common/icon/midyearCorner.png',  // 分享右边小图\r\n            'shareAppUrl': ipUrl+'/fanbei-web/activity/superGoods?superGoodsShare=superGoodsShare&activityId='+activityId,  // 分享后的链接\r\n            'isSubmit': 'N', // 是否需要向后台提交数据，Y需要，N不需要\r\n            'sharePage': 'superGoods' // 分享的页面\r\n          };\r\n          var dataStr = JSON.stringify(dataObj);  // json数组转换成json对象\r\n          return dataStr;\r\n        };"]}