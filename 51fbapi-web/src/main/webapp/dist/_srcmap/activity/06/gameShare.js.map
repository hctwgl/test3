{"version":3,"sources":["activity/06/gameShare.js"],"names":["getInfo","userName","url","chance","isLogin","data","isShow","recommendCode","getUrl","success","con","i","awardList","length","avatar","msg","console","html","requestMsg","$","animate","sixGame","start","self","x","this","css","click","hide","appendTo","goUp","slideDown","goDown","AutoScroll","obj","slideUp","marginTop","game","width","time","_classCallCheck","init","num","dataInit","claw","bind","reset","doll","clearInterval","startMove","marginLeft","Math","round","clearTimeout","Countdown","setTimeout","alertMsg","timeStart","setInterval","dollNum","state","show","location","href","left","attr","top","each","dollLeft","offset","clawLeft","dataProp","find","position","removeAttr","document","ready","onoff"],"mappings":"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","file":"../../../activity/06/gameShare.js","sourcesContent":["/**\r\n * Created by nizhiwei-labtop on 2017/5/31.\r\n */\r\nlet userName = \"\";\r\nif(getInfo().userName){\r\n    userName=getInfo().userName\r\n}\r\nlet chance=[],isLogin,isShow,recommendCode=getUrl('recommendCode');\r\n\r\n//数据初始化\r\nfunction dataInit() {\r\n    $.ajax({\r\n        url:'/fanbei-web/initGame.htm',\r\n        type:'post',\r\n        success:function (data) {\r\n            data=eval('(' + data + ')');\r\n            console.log(data);\r\n            if(data.success){\r\n                //娃娃中奖信息循环\r\n                let con='';\r\n                for(let i=0;i<data.data.awardList.length;i++){\r\n                    con+=`<li>\r\n                    <div class=\"personImg\" style=\"background-image:url('${data.data.awardList[i].avatar}')\"></div>\r\n                    <h2><span>${data.data.awardList[i].userName}</span><span>${data.data.awardList[i].msg}</span></h2></li>`\r\n                }\r\n                $('.awardList').html(con);\r\n            }else{\r\n                requestMsg('中奖名单获取失败');\r\n            }\r\n        }\r\n    });\r\n}\r\ndataInit();\r\n\r\n//游戏\r\nclass game{\r\n    constructor(width,time){\r\n        this.init={num:-(width),time:time};\r\n        this.num=-(width);\r\n        this.time=time;\r\n        $('#playBtn').click(this.claw.bind(this));\r\n\r\n    }\r\n    start(){\r\n        let self=this;\r\n        this.reset();\r\n        this.doll();\r\n        clearInterval(this.startMove);\r\n        this.startMove=setInterval(function (){\r\n            if(self.num>=0){\r\n                self.num=-8.25;\r\n                $('#scroll').animate({marginLeft:self.num+'rem'},0,'linear');\r\n            }\r\n            self.num=(Math.round(self.num*1000)+1650)/1000;    //避免浮点数错误\r\n            $('#scroll').animate({marginLeft:self.num+'rem'},1000,'linear');\r\n        },1000);\r\n        clearTimeout(this.Countdown);\r\n        this.Countdown=setTimeout(function(){                             //结束倒计时\r\n            if(isShow!='No'){\r\n                self.alertMsg('end');\r\n            }\r\n        },20000);\r\n        setTimeout(function(){                             //结束倒计时\r\n            $('.modelPic').hide();\r\n        },1000);\r\n\r\n    }\r\n    reset(){\r\n        $('#scroll').animate({marginLeft:this.init.num+'rem'},0,'linear');\r\n        $('#claw').css('backgroundImage','url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw1.png)');  //还原钩子\r\n        this.num=this.init.num;\r\n        this.time=this.init.time;\r\n        clearInterval(this.timeStart);\r\n        this.timeStart=setInterval(function () {\r\n            (this.time<=0)?this.time=0:this.time-=1;\r\n            $('#time').html(this.time+'秒');\r\n        }.bind(this),1000);\r\n    }\r\n    doll(){\r\n        let dollNum=[1,2,3,4,5,1,2,3,4,5];\r\n        let con='';\r\n        for(let i=0;i<dollNum.length;i++){\r\n            con+=`<span data-prop=\"${dollNum[i]}\" class=\"doll\"><div class=\"doll-main\" style=\"background-image: url('https://fs.51fanbei.com/h5/app/activity/06/ni_boll${dollNum[i]}.png')\"></div></span>`\r\n        }\r\n        $('#scroll').html(con)\r\n    }\r\n    alertMsg(state,item){\r\n        isShow='No';\r\n        $('.ad').hide();\r\n        if(state=='end'){\r\n            $('.getState').html('抓取失败');\r\n            $('.jushuo').show();\r\n        }\r\n        if(state=='claw'){\r\n            $('.getState').html('抓取成功');\r\n            $('.getCashCoupon').show();\r\n        }\r\n        $('#alert').show();\r\n        $('#shadow').show();\r\n        $('.tryAgain').click(function () {\r\n            $('#shadow').hide();\r\n            $('.alert').hide();\r\n        });\r\n        $('.goSign').click(function () {\r\n            location.href='gameRegister?recommendCode='+recommendCode;\r\n            $('#shadow').hide();\r\n            $('.alert').hide();\r\n        });\r\n        $('#startBtn').show();\r\n        $('.modelPic').show();\r\n    }\r\n    claw(){\r\n        let self=this;\r\n        let clawLeft=$('#claw').offset().left;\r\n        $('.button').attr('disabled','disabled');\r\n        $('#claw').animate({top:'-.5rem'},1500,function () {          //钩子下落\r\n            $('.doll').each(function () {\r\n                let doll=$(this);\r\n                let dollLeft=doll.offset().left;\r\n                if(dollLeft>(clawLeft-10) && dollLeft<(clawLeft+35)){          //判断钩子与娃娃是否重合，减的越大越偏右\r\n                    let dataProp=doll.attr('data-prop');\r\n                    // if(Math.floor(Math.random()*100+1)<clientRate){                 //随机能否抓到娃娃\r\n                        $('#claw').css('backgroundImage','url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw2.png)'); //钩子变为收缩样式\r\n                        doll.find('.doll-main').css({position:'absolute',left:'2.47rem'})       //娃娃脱离文档流并跟着上升\r\n                            .animate({top:'-2.2rem'},800,function () {\r\n                                $('.doll[data-prop='+dataProp+']').css('visibility','hidden');\r\n                                self.alertMsg('claw',dataProp);\r\n                            })\r\n                    // }\r\n                }\r\n            });\r\n            $('#claw').animate({top:'-2rem'},1000,function () {                 //钩子回升\r\n                $('.button').removeAttr('disabled');\r\n            });\r\n        })\r\n    }\r\n}\r\nlet sixGame= new game(16.5,20);\r\nsixGame.doll();\r\n$('#startBtn').click(function () {\r\n    isShow='yes';\r\n    let self=$(this);\r\n    $('.play').animate({top:'10.25rem'},200,function () {\r\n        $('.play').animate({top:'10.23rem'},150);\r\n        sixGame.start();\r\n        self.hide();\r\n        console.log(chance)\r\n    });\r\n});\r\n//阴影点击\r\n$('#shadow').click(function () {\r\n    $(this).hide();\r\n    $('.alert').hide()\r\n\r\n\r\n});\r\n\r\n//--------------------------------------yun--------------------------------------------\r\n//活动规则\r\n$('#rule').click(function(){\r\n    $('#rules').css('display','block');\r\n    $('#shadow').show();\r\n})\r\n$('.closeRules').click(function(){\r\n    $('#rules').css('display','none');\r\n    $('#shadow').hide();\r\n})\r\n\r\n\r\n\r\n\r\n//滚轮事件\r\nfunction AutoScroll(obj,x) {\r\n    $(obj).find(\"ul:first\").animate({\r\n            marginTop: x\r\n        },\r\n        500,\r\n        function() {\r\n            $(this).css({\r\n                marginTop: \"0\"\r\n            }).find(\"li:first\").appendTo(this);\r\n        });\r\n}\r\n$(document).ready(function() {\r\n    setInterval('AutoScroll(\".roll01\",\"-1rem\")', 1000);\r\n});\r\n\r\n\r\n// if(活动为开始时点击立即抓取 活动时间提示出现)\r\nfunction goUp(){\r\n    $('#shadow').css('display','block');\r\n    $('#getPrize').slideDown();\r\n    $('#allToy').css('z-index',300);\r\n    $('#allToy .gotoTop').css('transform','rotate(180deg)');\r\n}\r\nfunction goDown(){\r\n    $('#shadow').css('display','none');\r\n    $('#getPrize').slideUp();\r\n    $('#allToy').css('z-index',150);\r\n    $('#allToy .gotoTop').css('transform','rotate(0deg)');\r\n}\r\n$(function(){\r\n    //箭头点击事件\r\n    var onoff=1; //加上开关\r\n    $('#allToy .gotoTop').click(function(){\r\n        if(onoff==1){\r\n            goUp();\r\n            onoff=0;\r\n        } else {\r\n            goDown();\r\n            onoff=1;\r\n        }\r\n    })\r\n    //蒙版点击事件\r\n    $('#shadow').click(function(){\r\n        goDown()\r\n        onoff=1;\r\n    })\r\n\r\n});\r\n"]}