{"version":3,"sources":["activity/06/gameShare.js"],"names":["getInfo","userName","url","chance","isLogin","data","isShow","recommendCode","getUrl","success","con","i","awardList","length","avatar","msg","console","html","requestMsg","sixGame","start","x","self","hide","animate","$","click","css","marginTop","find","appendTo","this","goUp","AutoScroll","obj","game","width","time","_classCallCheck","init","num","dataInit","claw","bind","reset","doll","clearInterval","startMove","marginLeft","Math","round","clearTimeout","Countdown","setTimeout","alertMsg","timeStart","setInterval","dollNum","state","show","location","href","left","attr","top","each","dollLeft","offset","clawLeft","dataProp","position","removeAttr","document","ready","onoff","goDown"],"mappings":"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","file":"../../../activity/06/gameShare.js","sourcesContent":["/**\r\n * Created by nizhiwei-labtop on 2017/5/31.\r\n */\r\nlet userName = \"\";\r\nif(getInfo().userName){\r\n    userName=getInfo().userName\r\n}\r\nlet chance=[],isLogin,isShow,recommendCode=getUrl('recommendCode');\r\n\r\n//数据初始化\r\nfunction dataInit() {\r\n    $.ajax({\r\n        url:'/fanbei-web/initGame.htm',\r\n        type:'post',\r\n        success:function (data) {\r\n            data=eval('(' + data + ')');\r\n            console.log(data);\r\n            if(data.success){\r\n                //娃娃中奖信息循环\r\n                let con='';\r\n                for(let i=0;i<data.data.awardList.length;i++){\r\n                    con+=`<li>\r\n                    <div class=\"personImg\" style=\"background-image:url('${data.data.awardList[i].avatar}')\"></div>\r\n                    <h2><span>${data.data.awardList[i].userName}</span><span>${data.data.awardList[i].msg}</span></h2></li>`\r\n                }\r\n                $('.awardList').html(con);\r\n            }else{\r\n                requestMsg('中奖名单获取失败');\r\n            }\r\n        }\r\n    });\r\n}\r\ndataInit();\r\n\r\n//游戏\r\nclass game{\r\n    constructor(width,time){\r\n        this.init={num:-(width),time:time};\r\n        this.num=-(width);\r\n        this.time=time;\r\n        $('#playBtn').click(this.claw.bind(this));\r\n\r\n    }\r\n    start(){\r\n        let self=this;\r\n        this.reset();\r\n        this.doll();\r\n        clearInterval(this.startMove);\r\n        this.startMove=setInterval(function (){\r\n            if(self.num>=0){\r\n                self.num=-8.25;\r\n                $('#scroll').animate({marginLeft:self.num+'rem'},0,'linear');\r\n            }\r\n            self.num=(Math.round(self.num*1000)+1650)/1000;    //避免浮点数错误\r\n            $('#scroll').animate({marginLeft:self.num+'rem'},1000,'linear');\r\n        },1000);\r\n        clearTimeout(this.Countdown);\r\n        this.Countdown=setTimeout(function(){                             //结束倒计时\r\n            if(isShow!='No'){\r\n                self.alertMsg('end');\r\n            }\r\n        },20000);\r\n        setTimeout(function(){                             //结束倒计时\r\n            $('.modelPic').hide();\r\n        },1000);\r\n\r\n    }\r\n    reset(){\r\n        $('#scroll').animate({marginLeft:this.init.num+'rem'},0,'linear');\r\n        $('#claw').css('backgroundImage','url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw1.png)');  //还原钩子\r\n        this.num=this.init.num;\r\n        this.time=this.init.time;\r\n        clearInterval(this.timeStart);\r\n        this.timeStart=setInterval(function () {\r\n            (this.time<=0)?this.time=0:this.time-=1;\r\n            $('#time').html(this.time+'秒');\r\n        }.bind(this),1000);\r\n    }\r\n    doll(){\r\n        let dollNum=[1,2,3,4,5,1,2,3,4,5];\r\n        let con='';\r\n        for(let i=0;i<dollNum.length;i++){\r\n            con+=`<span data-prop=\"${dollNum[i]}\" class=\"doll\"><div class=\"doll-main\" style=\"background-image: url('https://fs.51fanbei.com/h5/app/activity/06/ni_boll${dollNum[i]}.png')\"></div></span>`\r\n        }\r\n        $('#scroll').html(con)\r\n    }\r\n    alertMsg(state,item){\r\n        isShow='No';\r\n        $('.ad').hide();\r\n        if(state=='end'){\r\n            $('.getState').html('抓取失败');\r\n            $('.jushuo').show();\r\n        }\r\n        if(state=='claw'){\r\n            $('.getState').html('抓取成功');\r\n            $('.getCashCoupon').show();\r\n        }\r\n        $('#alert').show();\r\n        $('#shadow').show();\r\n        $('.tryAgain').click(function () {\r\n            $('#shadow').hide();\r\n            $('.alert').hide();\r\n        });\r\n        $('.goSign').click(function () {\r\n            location.href='gameRegister?recommendCode='+recommendCode;\r\n            $('#shadow').hide();\r\n            $('.alert').hide();\r\n        });\r\n        $('#startBtn').show();\r\n        $('.modelPic').show();\r\n    }\r\n    claw(){\r\n        let self=this;\r\n        let clawLeft=$('#claw').offset().left;\r\n        $('.button').attr('disabled','disabled');\r\n        $('#claw').animate({top:'-.5rem'},1500,function () {          //钩子下落\r\n            $('.doll').each(function () {\r\n                let doll=$(this);\r\n                let dollLeft=doll.offset().left;\r\n                if(dollLeft>(clawLeft-10) && dollLeft<(clawLeft+35)){          //判断钩子与娃娃是否重合，减的越大越偏右\r\n                    let dataProp=doll.attr('data-prop');\r\n                    // if(Math.floor(Math.random()*100+1)<clientRate){                 //随机能否抓到娃娃\r\n                        $('#claw').css('backgroundImage','url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw2.png)'); //钩子变为收缩样式\r\n                        doll.find('.doll-main').css({position:'absolute',left:'2.47rem'})       //娃娃脱离文档流并跟着上升\r\n                            .animate({top:'-2.2rem'},800,function () {\r\n                                $('.doll[data-prop='+dataProp+']').css('visibility','hidden');\r\n                                self.alertMsg('claw',dataProp);\r\n                            })\r\n                    // }\r\n                }\r\n            });\r\n            $('#claw').animate({top:'-2rem'},1000,function () {                 //钩子回升\r\n                $('.button').removeAttr('disabled');\r\n            });\r\n        })\r\n    }\r\n}\r\nlet sixGame= new game(16.5,20);\r\nsixGame.doll();\r\n$('#startBtn').click(function () {\r\n    isShow='yes';\r\n    let self=$(this);\r\n    $('.play').animate({top:'10.25rem'},200,function () {\r\n        $('.play').animate({top:'10.23rem'},150);\r\n        sixGame.start();\r\n        self.hide();\r\n        console.log(chance)\r\n    });\r\n});\r\n//阴影点击\r\n$('#shadow').click(function () {\r\n    $(this).hide();\r\n    $('.alert').hide()\r\n\r\n\r\n});\r\n\r\n//--------------------------------------yun--------------------------------------------\r\n//活动规则\r\n$('#rule').click(function(){\r\n    $('#rules').css('display','block');\r\n    $('#shadow').show();\r\n})\r\n$('.closeRules').click(function(){\r\n    $('#rules').css('display','none');\r\n    $('#shadow').hide();\r\n})\r\n\r\n\r\n\r\n\r\n//滚轮事件\r\nfunction AutoScroll(obj,x) {\r\n    $(obj).find(\"ul:first\").animate({\r\n            marginTop: x\r\n        },\r\n        500,\r\n        function() {\r\n            $(this).css({\r\n                marginTop: \"0\"\r\n            }).find(\"li:first\").appendTo(this);\r\n        });\r\n}\r\n$(document).ready(function() {\r\n    setInterval('AutoScroll(\".roll01\",\"-1rem\")', 1000);\r\n});\r\n\r\n\r\n// if(活动为开始时点击立即抓取 活动时间提示出现)\r\nfunction goUp(){\r\n    $('#shadow').css('display','block');\r\n    $('#getPrize').slideDown();\r\n    $('#allToy').css('z-index',300);\r\n    $('#allToy .gotoTop').css('transform','rotate(180deg)');\r\n}\r\nfunction goDown(){\r\n    $('#shadow').css('display','none');\r\n    $('#getPrize').slideUp();\r\n    $('#allToy').css('z-index',150);\r\n    $('#allToy .gotoTop').css('transform','rotate(0deg)');\r\n}\r\n$(function(){\r\n    //箭头点击事件\r\n    var onoff=1; //加上开关\r\n    $('#allToy .gotoTop').click(function(){\r\n        if(onoff==1){\r\n            goUp();\r\n            onoff=0;\r\n        } else {\r\n            goDown();\r\n            onoff=1;\r\n        }\r\n    })\r\n    //蒙版点击事件\r\n    $('#shadow').click(function(){\r\n        goDown()\r\n        onoff=1;\r\n    })\r\n\r\n});\r\n"]}