{"version":3,"sources":["activity/06/getMore.js"],"names":["url","getData","data","dataType","subjectId","currentPage","success","List","total","totalCount","subjectGoodsList","i","length","console","log","type","goodsType","str","nperMap","goodsIcon","goodName","saleAmount","rebateAmount","notifyUrl","goodsId","amount","mount","freeAmount","isFree","nper","totalAmount","totalSize","remove","$","css","error","getUrl","window","scroll","document","scrollTop","height","animate","opacity"],"mappings":"YA2BYA,SAAIC,WACJC,EAAAA,MACAC,IAAS,+BACJD,MAJRE,UAAAA,UAAAC,YAAAA,aAKGC,SAAQ,OACEC,KAAKL,OACTM,QAAWN,SAAKO,GACJP,GAAZK,GAAAL,EAAAA,KAAAQ,gBACQC,OAAIA,EAAEJ,KAAKK,WACjBC,QAAAC,IAAAZ,EACIa,KAAKR,GAAAI,GAAQK,EAAAA,EAAAA,EAAjBJ,OAAAD,IAAA,CACS,GAAEM,EAGL,IAAA,GAFAV,EAAAI,GAAAK,UAGSE,EAAAA,yCAAmBX,EAAAI,GAAAQ,UAAA,iGAAAZ,EAAAI,GAAAS,SAAA,gCAAAb,EAAAI,GAAAU,WAAA,gDAAAd,EAAAI,GAAAW,aAAA,+BAAApB,EAAAA,KAAAqB,UAAA,6BAAAhB,EAAAI,GAAAa,QAAA,mCAEhBb,CACAJ,GAAV,GAAUA,EAAQW,GAAAA,QAAQO,OAC7B,GAAAC,GAAAnB,EAAAI,GAAAO,QAAAS,eACC,IAAA,GAAApB,EAAAI,GAAAO,QAAAU,OACL,GAAAF,GAAAnB,EAAAI,GAAAO,QAAAO,MAEFR,GAAA,yCAAAV,EAAAI,GAAAQ,UAAA,iGAAAZ,EAAAI,GAAAS,SAAA,yDAAAM,EAAA,MAAAnB,EAAAI,GAAAO,QAAAW,KAAA,4BAAAtB,EAAAI,GAAAO,QAAAY,YAAA,2CAEEC,EAAU,gBAAMA,OAAWvB,GAE1BuB,WAAexB,EAAjBK,QACDmB,UAAA,IAAAA,WAAAvB,SACWuB,EAAAA,SAAZC,SA9BTC,EAAA,WAAAC,IAAA,UAAA,IAiCoBrB,QAAXC,IAAAiB,YAjChBI,MAAA,WAoCA9B,WAAAA,WAAAA,cA7DF,GAAID,WAAUgC,OAAO,aAAjBhC,YAAUgC,EACV/B,UAAAA,EACA0B,KACJE,GAAA,WACEhC,UAEAgC,EAAAI,QAAAC,OAAA,WAGML,EAAEM,UAAUC,aAAeP,EAAEM,UAAUE,SAAWR,EAAEI,QAAQI,SAC7DR,EAAA,SAAAS,SAAAC,QAAA,KAAA,IAAA,WACE1C,YAAF8B,WAAAvB,QAGQuB,EAAAA,SAAWvB,SACKwB,EAAAA,WAAXE,IAAA,UAAA","file":"../../../activity/06/getMore.js","sourcesContent":["\r\nvar subjectId=getUrl('subjectId');\r\nvar currentPage=1;\r\nvar totalSize=0;\r\nvar total;\r\n$(function(){\r\n  getData();\r\n  //滚动条事件\r\n  $(window).scroll(function() {   \r\n\r\n     if($(document).scrollTop() >= $(document).height() - $(window).height()) {\r\n       //alert(\"滚动条已经到达底部为\");   \r\n       $('.load').animate({'opacity':'1'},200,function(){\r\n          getData();\r\n       }) \r\n     } else if(totalSize==total){\r\n                    $('.load').remove();\r\n                    $('.finish').css('opacity',1);\r\n                  }\r\n\r\n  });\r\n\r\n})\r\n\r\n\r\nfunction getData(){\r\n  $.ajax({\r\n            url:'/fanbei-web/subjectGoodsInfo',\r\n            data:{'subjectId':subjectId,'currentPage':currentPage},\r\n            dataType:'JSON',\r\n            type:'POST',\r\n            success:function(data){\r\n                  var List=data.data.subjectGoodsList;\r\n                  total=data.data.totalCount;\r\n                  console.log(data)\r\n                  for(var i=0;i<List.length;i++){\r\n                    var str;\r\n                    var type=List[i].goodsType;\r\n                    if(type==0){\r\n                      str='<li><div class=\"productImg\"><img src=\"'+List[i].goodsIcon+'\"></div><div class=\"productRight\"><p class=\"productDes\" style=\"-webkit-box-orient: vertical;\">'+List[i].goodName+'</p><p class=\"productPrice\">￥'+List[i].saleAmount+'</p><p class=\"fan\">返</p><p class=\"fanPrice\">￥'+List[i].rebateAmount+'</p><a class=\"buyNow\" href=\"'+data.data.notifyUrl+'&params={%22goodsId%22:%22'+List[i].goodsId+'%22}'\r\n+'\"}'+'\"}'+'\">马上抢</a></div></li>'\r\n                    } else{\r\n                        if(List[i].nperMap.isFree ==1){\r\n                            var mount=List[i].nperMap.freeAmount\r\n                        }else if(List[i].nperMap.isFree ==2){\r\n                            var mount=List[i].nperMap.amount\r\n                        }\r\n                      str='<li><div class=\"productImg\"><img src=\"'+List[i].goodsIcon+'\"></div><div class=\"productRight\"><p class=\"productDes\" style=\"-webkit-box-orient: vertical;\">'+List[i].goodName+'</p><p class=\"monthPrice\"><i class=\"monthCorner\"></i>￥'+mount+' x '+List[i].nperMap.nper+'</p><p class=\"buyPrice\">￥'+List[i].nperMap.totalAmount+'</p><p class=\"buyNow\">马上抢</p></div></li>'\r\n                    }                    \r\n                    $('#productList').append(str);\r\n                  }\r\n                  totalSize+=List.length;\r\n                  if(totalSize<20 || totalSize==total){\r\n                    $('.load').remove();\r\n                    $('.finish').css('opacity',1);\r\n                  }\r\n                  console.log(totalSize);\r\n            },\r\n            error:function(){\r\n                  requestMsg(\"请求失败\");\r\n            }\r\n        })\r\n  currentPage++; \r\n}\r\n\r\n"]}