{"version":3,"sources":["activity/06/receiveCoupons.js"],"names":["couponListString","$","val","couponList","eval","userName","click","i","this","index","couponIdNum","rid","eq","find","html","currentState","window","url","type","dataType","returnData","success","requestMsg","location","href","status","data","msg","css"],"mappings":"YAEA,IAAAA,kBAAAC,EAAA,eAAAC,MAGIC,WAAaC,KAAK,IAAMJ,iBAAmB,KAA3CG,SAAAA,EAAaC,aAAWJ,MAExBK,UAAWJ,aAEfA,GAAA,WAKIA,EAAE,aAAaK,MAAM,WADtB,GAAAC,GAAAN,EAAAO,MAAAC,QACGC,EAAmBP,WAAUI,GAAAI,GAEvBD,QADWD,EAAAA,aAAfG,GAAAL,GAAAM,KAAA,gBAAAC,OAEIC,OAAAA,SAAad,KAAE,wBAEfe,EAAAA,MACCC,IAAA,yBACSC,KAAA,OACFD,SAAK,OACLC,MACAC,SAHET,EAIIL,SAAAA,UAEFA,QAAAA,SAAUA,GANZ,GAAAe,EAAAC,QAQOC,WAAA,WACDF,EAAAA,aAAJR,GAAwBL,GAAAM,KAAA,gBAAAC,KAAA,OACpBQ,EAAAA,aAAWV,GAAXL,GAAAM,KAAA,gBAAAP,MAAA,WAGIU,OAAAO,SAAAC,KAAA,8BADJ,CAMG,GAAAC,GAAAL,EAAAM,KAAA,MACUN,mBAATK,IACAA,OAAUF,SAAAC,KAAdJ,EAAgCH,KAE/B,QAAAQ,IAGGH,WAAWF,EAAWO,KADtBF,WAAU,kBAEC,oBAAXH,IACHA,WAAAF,EAAAO,KAIG1B,EAAE,aAAaW,GAAGL,GAAGqB,IAAI,UAAW,WAApC3B,MAAAA,WACHqB,WAAA","file":"../../../activity/06/receiveCoupons.js","sourcesContent":["//点击我要领券时判断用户是否登录 此时要先判断系统 iPhone和andriod\r\n// getBlatFrom() == 2代表iOS\r\n//（参考motherDay点击抢优惠券function）\r\n\r\nvar couponListString = $(\"#couponList\").val();\r\nvar couponList = eval('(' + couponListString + ')');\r\n\r\nvar userName = $(\"#userName\").val();\r\n\r\nvar returnNum = getBlatFrom();\r\n\r\n$(function(){\r\n\r\n   // 点击领取优惠劵\r\n    $(\".couponLi\").click(function(){\r\n        var i= $(this).index();\r\n        var couponIdNum = couponList[i].rid;\r\n        var currentState=$(\".couponLi\").eq(i).find('.clickCoupon').html();\r\n        if(currentState==\"去用券\"){\r\n            window.location.href = \"activity/activityHome\";\r\n        }else{\r\n               $.ajax({\r\n                    url: \"/fanbei-web/pickCoupon\",\r\n                    type: \"POST\",\r\n                    dataType: \"JSON\",\r\n                    data: {\r\n                        couponId: couponIdNum,\r\n                        userName: userName\r\n                    },\r\n                    success: function(returnData){\r\n                        if (returnData.success) {\r\n                            requestMsg(\"优惠劵领取成功\");\r\n                            $(\".couponLi\").eq(i).find('.clickCoupon').html(\"去用券\");\r\n                            $(\".couponLi\").eq(i).find('.clickCoupon').click(function(){\r\n                                // window.location.href = \"activity/activityHome\";\r\n\r\n                                  window.location.href = \"activity/activityHome\";\r\n\r\n                            })\r\n                        } else {\r\n                            var status = returnData.data[\"status\"];\r\n                            if (status == \"USER_NOT_EXIST\") { // 用户不存在\r\n                                window.location.href = returnData.url;\r\n                            }\r\n\r\n                            if (status == \"OVER\") { // 优惠券个数超过最大领券个数\r\n                                requestMsg(returnData.msg);\r\n                                requestMsg(\"优惠券个数超过最大领券个数\");\r\n                            }\r\n\r\n                            if (status == \"COUPON_NOT_EXIST\") { // 优惠券不存在\r\n                                requestMsg(returnData.msg);\r\n                                $(\".couponLi\").eq(i).css('display', 'none');\r\n                            }\r\n                        }\r\n                    },\r\n                    error: function(){\r\n                        requestMsg(\"请求失败\");\r\n                    }\r\n               });\r\n           }\r\n       //$(this).unbind(\"click\"); // 移除当前元素的点击时间(禁止重复点击)\r\n    });\r\n});\r\n\r\n// var returnNum = getBlatFrom();  // 判断1为Android，2为ios\r\n//\r\n// /*------------跳转登陆+请求返回数据--------------*/\r\n// if(returnNum == 1){  // android机型\r\n//     $(\".myCoupon\").click(function(){\r\n//         alaAndroid.appLogin();  // 调用Android原生登陆\r\n//     });\r\n// }else{  // ios机型\r\n//     $(\".myCoupon\").click(function(){\r\n//         alaIos.appLogin();  // 调用ios原生登陆\r\n//     });\r\n// }\r\n//\r\n//\r\n// function loginSuccess() {\r\n//     if(returnNum == 1){  // android机型\r\n//         //(2222);\r\n//         var jsonString = '{\"className\":\"com.alfl.www.user.ui.VoucherMenuActivity\"}';\r\n//         alaAndroid.openActivity(jsonString);\r\n//     }else{  // ios机型\r\n//         location.href=\"/fanbei-web/opennative?name=MINE_COUPON_LIST\";\r\n//     }\r\n// }\r\n"]}