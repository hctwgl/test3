"use strict";var tabWidth=0,liWidth=0,ulWidth=0,vm=new Vue({el:"#newCouponCenter",data:{content:{}},created:function(){this.logData()},methods:{logData:function logData(){var self=this;$.ajax({type:"post",url:"/fanbei-web/couponCategoryInfo",success:function success(data){function format(t){var o=new Date(t),e=o.getFullYear(),n=o.getMonth()+1,i=o.getDate();return n<10&&(n="0"+n),i<10&&(i="0"+i),e+"."+n+"."+i}self.content=eval("("+data+")").data,console.log(self.content),""!=self.content.bannerImage&&void 0!=self.content.bannerImage||$(".banner").css("display","none");var liLength=self.content.couponCategoryList.length;self.$nextTick(function(){if($(".navList li").eq(0).addClass("border"),$(".contList li").eq(0).addClass("active"),liLength<2)$("#tabNav").hide(),$("#content").css("padding-top",0);else if(liLength>=2&&liLength<=5){tabWidth=$("#tabNav").width();for(var t=0;t<liLength;t++)liWidth+=$(".navList").find("li").eq(t).width();var o=(tabWidth-liWidth)/(liLength+1);$(".navList").find("li").css("margin-left",o)}else{tabWidth=$("#tabNav").width();for(var e=0,n=0;n<5;n++)e+=$(".navList").find("li").eq(n).width();for(var t=0;t<liLength;t++)liWidth+=$(".navList").find("li").eq(t).width();var o=(tabWidth-e)/6;$(".navList").find("li").css("margin-left",o),$(".kong").css("width",o),ulWidth=liWidth+(liLength+1)*o,$(".navList").width(ulWidth)}});for(var diff=0,i=0;i<liLength;i++){for(var couponCategory=self.content.couponCategoryList[i],j=0;j<couponCategory.couponInfoList.length;j++){var currentTime=couponCategory.couponInfoList[j].currentTime,startTime=couponCategory.couponInfoList[j].gmtStart,endTime=couponCategory.couponInfoList[j].gmtEnd;couponCategory.couponInfoList[j].start=format(startTime),couponCategory.couponInfoList[j].end=format(endTime),diff=(endTime-currentTime)/1e3;var h=parseInt(diff/3600),state;state=0<h&&h<48?"timeOver":"noTimeOver",couponCategory.couponInfoList[j].state=state}for(var j=0;j<couponCategory.couponInfoList.length;j++)for(var k=0;k<couponCategory.couponInfoList.length;k++)if(couponCategory.couponInfoList[j].gmtEnd<couponCategory.couponInfoList[k].gmtEnd){var tmp=couponCategory.couponInfoList[k];couponCategory.couponInfoList[k]=couponCategory.couponInfoList[j],couponCategory.couponInfoList[j]=tmp}}},error:function(){requestMsg("请求失败")}})},liClick:function(t){$(".navList li").eq(t).addClass("border"),$(".navList li").eq(t).siblings().removeClass("border"),$(".contList").find("li").eq(t).show().siblings().hide()},couponClick:function(t){var o=t.couponId,e=t.shopUrl,n=t.type;if("N"!=t.isDraw||"FULLVOUCHER"!=n&&"CASH"!=n&&"ACTIVITY"!=n){if("Y"==t.isDraw&&0==t.couponType)$.ajax({url:"/fanbei-web/pickCoupon",type:"POST",dataType:"JSON",data:{couponId:o},success:function(o){if(o.success)requestMsg("优惠劵领取成功"),t.isDraw="N";else{var e=o.data.status;"USER_NOT_EXIST"==e&&(window.location.href=o.url),"OVER"==e&&(requestMsg(o.msg),requestMsg("优惠券个数超过最大领券个数")),"COUPON_NOT_EXIST"==e&&(requestMsg(o.msg),$(".couponLi").eq(i).css("display","none"))}},error:function(){requestMsg("请求失败")}});else if("Y"==t.isDraw&&1==t.couponType){var a=t.couponId;$.ajax({url:"/fanbei-web/pickBoluomeCouponV1",type:"POST",dataType:"JSON",data:{sceneId:a},success:function(o){console.log(o),o.success?(requestMsg(o.msg),t.isDraw="N"):window.location.href=o.url},error:function(){requestMsg("请求失败")}})}}else window.location.href=e||"/fanbei-web/opennative?name=APP_HOME"}}});
//# sourceMappingURL=../../_srcmap/js/app/newCouponCenter.js.map
