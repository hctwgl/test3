"use strict";var goodsId=getUrl("goodsId"),discout=getUrl("discout"),rebate=getUrl("rebate");$(function(){$("#gamePay").height($(window).height()),$(".footer").height(.07*$(window).height()),$(".allTop").height(.93*$(window).height())});var vm=new Vue({el:"#gamePay",data:{content:{},fixCont:{},dataType:"",allData:[],allDataLen:"",discout:discout,rebate:rebate,needGameNumShow:"",liIndex:"",areaIndex:0,maskShow:"",serviceList:[],initPriceList:[]},created:function(){this.logData()},methods:{rewritedata:function(e){var a=e,t=Object.create(null),i=function(e,a,t){return t?$(e).find(a).attr(t):$(e).find(a)},n=function(e,a){return $(e).attr(a)};(i(a,"game","name")||n(a,"name"))&&(t.gameName=i(a,"game","name")||n(a,"name")),(i(a,"game","needGameAcct")||n(a,"needGameAcct"))&&(t.needGameAcct=i(a,"game","needGameAcct")||n(a,"needGameAcct"));var o=$(a).find("acctType").text();if(o?t.accountType=o:$(".gameNum").hide(),$(a).find("area")&&$(a).find("area").attr("name")){$(".gameArea").show();var s=i(a,"areas"),r=s.length;if(r&&r>=2&&(t.areasList=s.map(function(e,a){var t=i(a,"area"),o=[];return t.length&&t.each(function(e,a){o.push(n(a,"name"))}),{text:n(a,"name"),children:o}}),t.areasList=Array.prototype.slice.call(t.areasList),t.areaslen=r),r&&1==r){var m=$(a).find("area").length,c=[];m&&$(a).find("area").each(function(){c.push($(this).attr("name"))}),t.areasList=c,t.areaslen=r}}var l=[];i(a,"type","name")?($(a).find("type").each(function(){l.push($(this).attr("name"))}),t.typeNameList=l):i(a,"types","name")?($(a).find("types").each(function(){l.push($(this).attr("name"))}),t.typeNameList=l):$(".gameType").hide();for(var d=[],h=[],f=[],p=0;p<$(a).find("type").length;p++){h[p]=$(a).find("type").eq(p).children("quantity").text().split(","),f[p]=$(a).find("type").eq(p).children("chargeNum").text().split(",");for(var g=[],u=0;u<h[p].length;u++){var C={quantity:h[p][u],chargeNum:f[p][u]};g.push(C)}var y={chargeNumName:$(a).find("type").eq(p).children("chargeNum").attr("name")?$(a).find("type").eq(p).children("chargeNum").attr("name"):"",priceTimes:$(a).find("type").eq(p).children("quantity").attr("priceTimes"),list:g};d.push(y)}return t.priceTypeList=d,t},logData:function(){var e=this;$.ajax({type:"post",url:"/game/pay/goodsInfo",data:{goodsId:goodsId},success:function(a){if(e.content=a.data.content,e.dataType=a.data.xmlType,console.log(e.content),e.$nextTick(function(){$(e.content).find("deposititem").attr("nameDesc")&&($(".nameDesc").html($(e.content).find("deposititem").attr("nameDesc")),$(".nameDesc01").attr("placeholder","请输入"+$(e.content).find("deposititem").attr("nameDesc"))),$(e.content).find("deposititem").attr("nameconfirmDesc")&&($(".nameconfirmDesc").html($(e.content).find("deposititem").attr("nameconfirmDesc")),$(".nameconfirmDesc01").attr("placeholder","请"+$(e.content).find("deposititem").attr("nameconfirmDesc")))}),$(e.content).find("game").each(function(a,t){e.allData.push(e.rewritedata(t))}),console.log(e.allData,"全部数据"),console.log(e.allData.length,"全部数据长度"),e.fixCont=e.allData[0],console.log(e.allData[0],"默认显示第一个数据"),e.liIndex=0,e.initPriceList=e.allData[0].priceTypeList[0],e.fixCont.areasList)for(var t=0;t<e.fixCont.areasList.length;t++)e.fixCont.areasList[0].children?($(".gameService").show(),e.fixCont.initArea=e.fixCont.areasList[0].text,e.fixCont.initService=e.fixCont.areasList[0].children[0]):e.fixCont.initArea=e.fixCont.areasList[0];e.allDataLen=e.allData.length,1==e.allDataLen&&(e.fixCont=e.allData[0]),e.$nextTick(function(){$(".typeList li").eq(0).addClass("changeColor01"),$(".typeList li").eq(0).find("p").addClass("changeColor02"),$(".moneyList li").eq(0).addClass("changeColor01"),$(".moneyList li").eq(0).find("p").addClass("changeColor02"),$(".payMoney span").html($(".moneyList li").eq(0).find(".typePrice").html()),$(".fanMoney span").html(($(".moneyList li").eq(0).find(".pricePay").html()*rebate).toFixed(2)+"元"),$(".gameNum input").attr("placeholder","请输入"+e.fixCont.accountType)}),"1"==e.fixCont.needGameAcct&&(e.needGameNumShow=!0)},error:function(){requestMsg("哎呀，出错了！")}})},gameNameClick:function(){this.maskShow=!0,$(".nameCont").animate({bottom:0},400)},chooseName:function(e,a){var t=this;if(t.fixCont=t.allData[e],console.log(t.fixCont),$(".gameName:first-child").find("span").html(a.gameName),t.maskShow=!1,$(".nameCont").animate({bottom:"-8.7rem"},0),"1"==t.fixCont.needGameAcct?t.needGameNumShow=!0:t.needGameNumShow=!1,t.fixCont.areasList)for(var i=0;i<t.fixCont.areasList.length;i++)t.fixCont.areasList[0].children?($(".gameService").show(),t.fixCont.initArea=t.fixCont.areasList[0].text,t.fixCont.initService=t.fixCont.areasList[0].children[0]):t.fixCont.initArea=t.fixCont.areasList[0]},gameAreaClick:function(){var e=this;e.fixCont.areaslen&&(e.maskShow=!0,$(".areaCont").animate({bottom:0},400))},chooseArea:function(e){var a=this;a.areaIndex=e,a.fixCont.areasList[a.areaIndex].children&&(a.serviceList=a.fixCont.areasList[a.areaIndex].children,$(".serviceCont").animate({bottom:0},400)),1==a.fixCont.areaslen&&($(".gameArea span").html(a.fixCont.areasList[a.areaIndex]),a.maskShow=!1,$(".areaCont").animate({bottom:"-8.7rem"},0)),a.fixCont.areaslen>=2&&$(".gameArea span").html(a.fixCont.areasList[a.areaIndex].text)},gameServiceClick:function(){var e=this;e.serviceList=e.fixCont.areasList[e.areaIndex].children,e.maskShow=!0,$(".serviceCont").animate({bottom:0},400)},chooseService:function(e){var a=this;$(".gameService span").html(a.serviceList[e]),a.maskShow=!1,$(".areaCont").animate({bottom:"-8.7rem"},0),$(".serviceCont").animate({bottom:"-8.7rem"},0)},gameTypeClick:function(e){var a=this;$(".typeList li").eq(e).addClass("changeColor01"),$(".typeList li").eq(e).find("p").addClass("changeColor02"),$(".typeList li").eq(e).siblings().removeClass("changeColor01"),$(".typeList li").eq(e).siblings().find("p").removeClass("changeColor02"),a.initPriceList=a.fixCont.priceTypeList[e],console.log(a.initPriceList,"000"),$(".payMoney span").html((a.initPriceList.list[0].quantity*discout).toFixed(2)+"元"),$(".fanMoney span").html((a.initPriceList.list[0].quantity*discout*rebate).toFixed(2)+"元")},gameMoneyClick:function(e){$(".moneyList li").eq(e).addClass("changeColor01"),$(".moneyList li").eq(e).find("p").addClass("changeColor02"),$(".moneyList li").eq(e).siblings().removeClass("changeColor01"),$(".moneyList li").eq(e).siblings().find("p").removeClass("changeColor02"),$(".payMoney span").html($(".moneyList li").eq(e).find(".pricePay").html()+"元"),$(".fanMoney span").html(($(".moneyList li").eq(e).find(".pricePay").html()*rebate).toFixed(2)+"元"),this.liIndex=e},sureClick:function(){var e=this,a=void 0,t=void 0,i=void 0,n=void 0,o=void 0,s=void 0,r=void 0,m=void 0,c=void 0,l=void 0,d=void 0,h=void 0;e.fixCont.priceTypeList&&(a=e.initPriceList.list[e.liIndex].quantity,t=e.initPriceList.priceTimes),m=e.needGameNumShow?$(".needGameNum input").val():"",c=$(".gameName").hasClass("gameArea")?$(".gameArea span").html():"",d=$(".gameName").hasClass("gameService")?$(".gameService span").html():"",l=$(".payType").hasClass("gameType")?$(".typeList .changeColor02").html():"","A"==e.dataType&&(i=$(".gameName:first-child").find("span").html(),n=$(".gameNum p").html(),o=$(".gameNum input").val(),s=t*a,r=$(".changeColor01 .pricePay").html()),"B"==e.dataType&&(i=$(".gameName:first-child").find("span").html(),n=$(".nameDesc").html(),o=$(".nameDesc01").val(),s=t*a,r=$(".changeColor01 .pricePay").html()),h=$(".changeColor01 .goodsNum").html(),$(".gameNum input").val()||o&&$(".nameconfirmDesc01").val()==o&&!e.needGameNumShow||o&&$(".nameconfirmDesc01").val()==o&&m?$.ajax({type:"post",url:"/game/pay/order",data:{goodsId:goodsId,gameName:i,acctType:n,userName:o,goodsNum:s,actualAmount:r,gameAcct:m,gameArea:c,gameSrv:d,gameType:l,priceTimes:t,goodsCount:h},success:function(e){console.log(e,"确认充值");var a=e.data.orderNo;window.location.href="gameOrderDetail?orderNo="+a},error:function(){requestMsg("哎呀，出错了！")}}):"B"==e.dataType&&$(".nameDesc01").val()!=$(".nameconfirmDesc01").val()?requestMsg($(".nameDesc").html()+"填写不一致！"):requestMsg("信息填写不完整！")},fixStrToNum:function(e){return parseInt(e)},fixNum:function(e){return e.toFixed(2)},maskClick:function(){this.maskShow=!1,$(".nameCont").animate({bottom:"-8.7rem"},0),$(".areaCont").animate({bottom:"-8.7rem"},0),$(".serviceCont").animate({bottom:"-8.7rem"},0)},maskClick01:function(){var e=this;$(".sameCont").hasClass("areaCont")&&"0px"==$(".areaCont").css("bottom")?$(".serviceCont").animate({bottom:"-8.7rem"},0):(e.maskShow=!1,$(".serviceCont").animate({bottom:"-8.7rem"},0))}}});
//# sourceMappingURL=../../_srcmap/activity/11/gamePay.js.map
