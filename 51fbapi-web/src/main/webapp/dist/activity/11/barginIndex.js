"use strict";var protocol=window.location.protocol,host=window.location.host,urlHost=protocol+"//"+host,vm=new Vue({el:"#barginIndex",data:{shareTime:0,totalData:{},firstGoods:{},ruleFlag:!1,downTime:{d:0,h:0,m:0,s:0},couponNum:0,isWX:!1,pageNo:1,sureFlag:!1,goodsId:0,cutData:""},created:function(){this.logData(),this.judge()},computed:{couponNum:function(){return this.firstGoods.couponList?this.firstGoods.couponList.filter(function(t,o){return 0===t.state}).length:0}},methods:{judge:function(){"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?this.isWX=!0:this.isWX=!1},logData:function(){var t=this;$.ajax({url:"/activity/de/goods",type:"POST",dataType:"json",success:function(o){if(console.log("initData=",o.data),console.log("initData=",o.data.goodsList[0].couponList),!o.success)return requestMsg("哎呀，出错了！"),!1;t.totalData=o.data,t.getFirstData(),t.countDown(),t.getShareTimes()},error:function(){requestMsg("哎呀，出错了！")}})},getFirstData:function(){for(var t=this,o=t.totalData.goodsList,e=o.length-1;e>=0;e--)if(1==o[e].type){t.firstGoods=o[e];break}},getShareTimes:function(){var t=this,o=t.totalData.goodsList;console.dir(t.totalData,t.shareTime);for(var e=0;e<o.length;e++)1==o[e].share&&1!=o[e].type&&t.shareTime++},showRule:function(){this.ruleFlag=!0},closeRule:function(){this.ruleFlag=!1},closeSure:function(){this.sureFlag=!1},share:function(t,o){if(this.goodsId=t,"product"==o){if(this.shareTime>=2)return requestMsg("只能砍价两件商品，不要太贪心哦"),!1;this.sureFlag=!0}else this.shareSure()},shareSure:function(){if(this.sureFlag=!1,this.isWX)this.toProduct(this.goodsId,"product");else{var t={shareAppTitle:"51返呗邀请有礼，快来参与~",shareAppContent:"我知道一个反利APP，购物不仅返现，邀请好友也赚钱哦~",shareAppImage:"https://f.51fanbei.com/h5/common/icon/midyearCorner.png",shareAppUrl:urlHost+"/fanbei-web/activity/barginProduct?goodsId="+this.goodsId+"&productType=product&userName="+getInfo().userName+"&testUser="+getInfo().userName,isSubmit:"Y",sharePage:"barginIndex"};t=JSON.stringify(t);var o=BASE64.encoder(t);window.location.href="/fanbei-web/opennative?name=APP_SHARE&params="+o}},toList:function(t){location.href="/fanbei-web/activity/barginList?goodsId="+t},toProduct:function(t,o){location.href="/fanbei-web/activity/barginProduct?goodsId="+t+"&productType="+o+"&testUser="+getInfo().userName},countDown:function(){var t=this;setInterval(function(){var o=(t.totalData.endTime-(new Date).getTime())/1e3,e=0,a=0,i=0,s=0;o>=0&&(e=Math.floor(o/60/60/24),a=Math.floor(o/60/60%24),i=Math.floor(o/60%60),s=Math.floor(o%60)),t.downTime.d=e,t.downTime.h=a,t.downTime.m=i,t.downTime.s=s},1e3)},couponClick:function(t){var o=t.couponId;$.ajax({url:"/fanbei-web/pickCoupon",type:"POST",dataType:"JSON",data:{couponId:o},success:function(t){return console.log("假装领取了优惠券。couponClickReturn=",t),!1},error:function(){requestMsg("哎呀，出错了！")}})},buy:function(){this.isWX?location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.alfl.www":window.location.href='/fanbei-web/opennative?name=GOODS_DETAIL_INFO&params={"privateGoodsId":"'+goodsId+'"}'}}});
//# sourceMappingURL=../../_srcmap/activity/11/barginIndex.js.map
