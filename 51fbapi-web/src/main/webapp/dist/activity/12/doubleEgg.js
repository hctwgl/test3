"use strict";function alaShareData(){var t={appLogin:"N",type:"share",shareAppTitle:"元旦狂欢盛宴 畅想欢乐购",shareAppContent:"抢神券红包雨 1212元秒杀iPhone X，X任性到底，欢乐购不停~",shareAppImage:"http://f.51fanbei.com/h5/app/activity/12/doubleEgg_shareIcon.png",shareAppUrl:domainName+"/fanbei-web/activity/doubleEgg.html?groupId="+groupId+"&spread=2&javaUrl=testapp.51fanbei.com&port=443",isSubmit:"Y",sharePage:"doubleEgg"};return JSON.stringify(t)}var protocol=window.location.protocol,host=window.location.host,urlHost=protocol+"//"+host,domainName=protocol+"//"+host,groupId=getUrl("groupId"),userName=getUrl("userName"),spread=getUrl("spread"),vm=new Vue({el:"#main",data:{goodsData:[],nowkey:0,nowkey2:0,couponData:[],currentData:[],triangleFlag:0,isApp:!0,couponUrl:"/appH5DoubleEggs/initCoupons",goodUrl:"/appH5DoubleEggs/getSecondKillGoodsList",currentGood:[],brandData:{},brandList:"",secondBrandList:"",tabFlag:!1,nowTime:0,secondKillData:"",loadFlag:[!1,!1,!1]},created:function(){this.isAppFn(),this.maidian("enter=true")},watch:{loadFlag:function(){this.loadFlag[0]&&this.loadFlag[1]&&this.loadFlag[2]&&this.$nextTick(function(){setTimeout(function(){$("#tabBox").pin({containerSelector:".good_con"})},0)})}},computed:{couponNum:function(){return this.firstGoods.couponList?this.firstGoods.couponList.filter(function(t,o){return 0!=t.state}).length:0}},methods:{changetab:function(t){this.nowkey=t,this.nowkey2=0,this.secondBrandList=this.brandList[t].secondCategoryList,this.changeGoodsData(t,0),this.tabFlag=!1},changetab2:function(t){this.nowkey2=t,this.changeGoodsData(this.nowkey,t)},isAppFn:function(){"app"!=getUrl("spread")&&(this.isApp=!1,this.couponUrl="/H5DoubleEggs/initCoupons",this.goodUrl="/H5DoubleEggs/getSecondKillGoodsList"),this.logData()},logData:function(){var t=this;$.ajax({url:t.couponUrl,type:"POST",dataType:"json",data:{groupId:groupId},success:function(o){if($(".loadingMask").fadeOut(),!o.success)return""!=o.data||requestMsg("哎呀，获取优惠券出错了！"),!1;t.couponData=o.data.couponList},error:function(){requestMsg("哎呀，出错了！")},complete:function(){t.$set(t.loadFlag,0,"true")}}),$.ajax({url:t.goodUrl,type:"POST",dataType:"json",success:function(o){if(!o.success)return requestMsg("哎呀，获取商品信息出错了！"),!1;$(".loadingMask").fadeOut(),t.secondKillData=o.data.goodsList,t.nowTime=o.data.serviceDate;var e=new Date(parseInt(t.nowTime)).toLocaleString();e=e.replace(new RegExp(/-/gm),"/");for(var a=e.split(" "),s=a[0].split("/"),n=new Date(a[0]).getTime(),i=0;i<t.secondKillData.length;i++){var r=t.secondKillData[i].startTime,c=new Date(parseInt(r)).toLocaleString();c=c.replace(new RegExp(/-/gm),"/");var a=c.split(" "),s=a[0].split("/"),d=s[1]+"月"+s[2]+"日";t.secondKillData[i].date=d,t.secondKillData[i].day=new Date(a[0]).getTime(),n>t.secondKillData[i].day?t.secondKillData[i].type=0:n==t.secondKillData[i].day?t.secondKillData[i].type=1:t.secondKillData[i].type=2}var u=!1;for(var l in t.secondKillData)if(t.secondKillData.hasOwnProperty(l)){var g=t.secondKillData[l];1==g.type&&(t.currentData=g,t.triangleFlag=l,u=!0)}u?(t.$nextTick(function(){var t=$("#dayBox").width(),o=$(".status-2").width(),e=(t-o)/2,a=$(".status-2").offset().left;if(a>e){var s=a-e;$("#dayBox").scrollLeft(s)}}),t.countDown(t.triangleFlag)):(t.currentData=t.secondKillData[0],t.triangleFlag=0)},error:function(){requestMsg("哎呀，出错了！")},complete:function(){t.$set(t.loadFlag,1,"true")}}),$.ajax({url:"/appH5DoubleEggs/initOnsaleGoods",type:"POST",dataType:"json",success:function(o){if(!o.success)return requestMsg("哎呀，获取品牌出错了！"),!1;t.brandData=o.data,t.brandList=o.data.firstCategoryList,t.secondBrandList=o.data.firstCategoryList[0].secondCategoryList,t.currentGood=o.data.goodsList,t.initGoodsData()},error:function(){requestMsg("哎呀，出错了！")},complete:function(){t.$set(t.loadFlag,2,"true")}})},initGoodsData:function(){var t=this,o=t.brandList;t.goodsData=new Array(o.length);for(var e=0;e<o.length;e++)t.goodsData[e]=new Array(o[e].secondCategoryList.length);t.goodsData[0][0]=t.currentGood},changeGoodsData:function(t,o){if(void 0==this.goodsData[t][o]){var t=this.brandList[t].secondCategoryList[o];void 0!=t&&this.getGoodsData(this.secondBrandList[o].secondCategoryId,t,o)}else this.currentGood=this.goodsData[t][o]},getGoodsData:function(t,o,e){var a=this;$.ajax({url:"/appH5DoubleEggs/getOnSaleGoods",type:"POST",data:{secondCategoryId:t},success:function(t){if(!t.success)return requestMsg("哎呀，获取品牌出错了！"),!1;a.goodsData[a.nowkey][a.nowkey2]=t.data.goodsList,a.currentGood=t.data.goodsList},error:function(){requestMsg("哎呀，出错了！")}})},countDown:function(t){var o=this,e=o.secondKillData[t];console.log("time=",e);var a=setInterval(function(){if(o.nowTime+=1e3,o.nowTime>=e.startTime){for(var t=0;t<e.goodsListForDate.length;t++){e.goodsListForDate[t].status=2}clearInterval(a)}},1e3)},couponClick:function(t,o){var e=this,a=t.id;return e.isApp?"Y"==t.isGet?(requestMsg("您已经领取过了，快去使用吧"),!1):"N"==t.isShow?(requestMsg("活动暂未开始,敬请期待"),!1):"E"==t.isShow?(requestMsg("活动已结束"),!1):void $.ajax({url:"/fanbei-web/pickCoupon",type:"POST",dataType:"JSON",data:{couponId:a},success:function(t){if(t.success)requestMsg("优惠劵领取成功"),e.$set(e.couponData[o],"isGet","Y"),e.maidian("couponSuccess=true&couponId="+a);else{var s=t.data.status;"USER_NOT_EXIST"==s&&(window.location.href=t.url),"OVER"==s&&(requestMsg("您已经领取过了，快去使用吧"),e.maidian("couponSuccess=got&couponId="+a)),"COUPON_NOT_EXIST"==s&&(requestMsg(t.msg),e.maidian("couponSuccess=noCoupon&couponId="+a)),"MORE_THAN"==s&&(requestMsg(t.msg),e.maidian("couponSuccess=end&couponId="+a))}},error:function(){requestMsg("哎呀，出错了！")}}):(this.toRegister(),!1)},productFn:function(t,o){if(console.log(1==this.isApp),this.isApp){if(0==this.secondKillData[this.triangleFlag].type)return!1;if(0==t.status)this.bookFn(t,o);else{if(1==t.status)return requestMsg("您已预约过，无需再预约"),!1;if(2==t.status){if(0==t.count)return requestMsg("您来晚了，商品已抢光"),!1;this.maidian("secKillGoodId="+t.doubleGoodsId),window.location.href='/fanbei-web/opennative?name=GOODS_DETAIL_INFO&params={"privateGoodsId":"'+t.doubleGoodsId+'"}'}else requestMsg("您已秒杀过此商品")}}else{if(0==t.type)return!1;this.toRegister()}},bookFn:function(t,o){this.maidian("bookBtn=click");var e=this;$.ajax({url:"/appH5DoubleEggs/subscribe",type:"POST",dataType:"json",data:{goodsId:t.doubleGoodsId},success:function(t){if(!t.success)return t.data.loginUrl?(location.href=t.data.loginUrl,!1):(requestMsg("哎呀，出错了,预约失败"),!1);requestMsg("设置提醒成功，商品开抢后将短信通知您"),e.secondKillData[e.triangleFlag].goodsListForDate[o].status=1,e.maidian("bookBtn=success")},error:function(){requestMsg("哎呀，出错了！")}})},buy:function(t){this.maidian("clickProductId="+t),this.isApp?window.location.href='/fanbei-web/opennative?name=GOODS_DETAIL_INFO&params={"privateGoodsId":"'+t+'"}':this.toRegister()},maidian:function(t){$.ajax({url:"/fanbei-web/postMaidianInfo",type:"post",data:{maidianInfo:"/fanbei-web/activity/doubleEgg?userName="+userName+"&"+t,maidianInfo1:spread},success:function(t){console.log(t)}})},changeProduct:function(t){this.currentData=this.secondKillData[t],this.triangleFlag=t,$(".product-box").scrollLeft(0)},showMore:function(){this.tabFlag=!0},closeMore:function(){this.tabFlag=!1},toRegister:function(){location.href="doubleEggRegister.html?spread="+spread},initScroll:function(){var t=sessionStorage.getItem("goodType");null!=t&&(this.nowkey=t,setTimeout(function(){$(window).scrollTop(sessionStorage.getItem("scrollTop")),sessionStorage.clear()},100))}}}),shareInfo={title:"元旦狂欢盛宴 畅想欢乐购",desc:"抢神券红包雨 1212元秒杀iPhone X，元旦任性到底，欢乐购不停~",link:domainName+"/fanbei-web/activity/doubleEgg.html?groupId="+groupId+"&spread="+spread+"&javaUrl=testapp.51fanbei.com&port=443",imgUrl:"http://f.51fanbei.com/h5/app/activity/12/doubleEgg_shareIcons.png",success:function(){alert("分享成功！")},error:function(){alert("分享失败！")},cancel:function(t){alert("取消分享！")}};
//# sourceMappingURL=../../_srcmap/activity/12/doubleEgg.js.map
