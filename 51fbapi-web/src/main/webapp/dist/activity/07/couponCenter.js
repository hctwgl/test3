"use strict";var tabWidth=0,liWidth=0,ulWidth=0,vm=new Vue({el:"#couponCenter",data:{content:{}},created:function(){this.logData()},methods:{logData:function logData(){var self=this;$.ajax({type:"post",url:"/fanbei-web/couponCategoryInfo",success:function success(data){function format(t){var o=new Date(t),e=o.getFullYear(),n=o.getMonth()+1,i=o.getDate();return n<10&&(n="0"+n),i<10&&(i="0"+i),e+"."+n+"."+i}self.content=eval("("+data+")").data,console.log(self.content);var liLength=self.content.couponCategoryList.length;self.$nextTick(function(){$(".navList li").eq(0).find("span").addClass("border"),$(".contList li").eq(0).addClass("active"),liLength<2?$("#tabNav").hide():liLength>=2&&liLength<=5&&(tabWidth=$("#tabNav").width(),liWidth=tabWidth/liLength,$(".navList").find("li").width(liWidth))});for(var diff=0,i=0;i<liLength;i++)for(var couponCategory=self.content.couponCategoryList[i],j=0;j<couponCategory.couponInfoList.length;j++){var currentTime=couponCategory.couponInfoList[j].currentTime,startTime=couponCategory.couponInfoList[j].gmtStart,endTime=couponCategory.couponInfoList[j].gmtEnd;couponCategory.couponInfoList[j].start=format(startTime),couponCategory.couponInfoList[j].end=format(endTime),diff=(endTime-currentTime)/1e3;var h=parseInt(diff/3600),state;state=h<48?"timeOver":"noTimeOver",couponCategory.couponInfoList[j].state=state}},error:function(){requestMsg("请求失败")}})},liClick:function(t){console.log(t),$(".navList li").eq(t).find("span").addClass("border"),$(".navList li").eq(t).siblings().find("span").removeClass("border"),$(".contList").find("li").eq(t).show().siblings().hide()},couponClick:function(t){var o=t.couponId,e=t.shopUrl;"Y"==t.isDraw?e?window.location.href=e:(console.log(0),window.location.href="https://www.baidu.com/"):(console.log(1),$.ajax({url:"/fanbei-web/pickCoupon",type:"POST",dataType:"JSON",data:{couponId:o},success:function(o){if(o.success)t.isDraw="Y";else{var e=o.data.status;"USER_NOT_EXIST"==e&&(window.location.href=o.url),"OVER"==e&&(requestMsg(o.msg),requestMsg("优惠券个数超过最大领券个数")),"COUPON_NOT_EXIST"==e&&(requestMsg(o.msg),$(".couponLi").eq(i).css("display","none"))}},error:function(){requestMsg("请求失败")}}))}}});
//# sourceMappingURL=../../_srcmap/activity/07/couponCenter.js.map
