"use strict";var activityId=getUrl("activityId"),vm=new Vue({el:"#robCoupon",data:{content:{},couponContent:{}},created:function(){this.logData()},methods:{logData:function logData(){var self=this;$.ajax({type:"post",url:"/fanbei-web/encoreActivityInfo",data:{activityId:activityId},success:function success(data){function showTime(e){diff=parseInt((e-currentTime)/1e3);var t=0,n=0,r=0;t=Math.floor(diff/3600),n=Math.floor(diff/60)-60*t,r=Math.floor(diff)-60*t*60-60*n,t<=9&&(t="0"+t),n<=9&&(n="0"+n),r<=9&&(r="0"+r),$(".countTime").find("span").eq(0).html(t),$(".countTime").find("span").eq(1).html(n),$(".countTime").find("span").eq(2).html(r)}function interval(e,t,n,r,i){currentTime<e?(showTime(e),$(".timeName").html("10:00")):currentTime>=e&&currentTime<i?currentTime<t?(showTime(t),$(".timeName").html("14:00")):currentTime>=t&&currentTime<n?(showTime(n),$(".timeName").html("10:00")):currentTime>=n&&(showTime(r),$(".timeName").html("14:00")):($(".timeName").html("14:00"),$(".desWord").find("p").eq(2).hide(),$(".countTime").hide());setInterval(function(){currentTime<e?(currentTime+=1e3,showTime(e),$(".timeName").html("10:00")):currentTime>=e&&currentTime<i?currentTime<t?(showTime(t),currentTime+=1e3,$(".timeName").html("14:00")):currentTime>=t&&currentTime<n?(showTime(n),currentTime+=1e3,$(".timeName").html("10:00")):currentTime>=n&&(showTime(r),currentTime+=1e3,$(".timeName").html("14:00")):($(".timeName").html("14:00"),$(".desWord").find("p").eq(2).hide(),$(".countTime").hide())},1e3)}self.content=eval("("+data+")"),self.content=self.content.data,console.log(self.content);var currentTime=self.content.currentTime,validStartTime=self.content.validStartTime+36e6,validEndTime=self.content.validEndTime,date=new Date(currentTime),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate(),dateStr01=year+"/"+month+"/"+day+" 10:00:00",dateStr02=year+"/"+month+"/"+day+" 14:00:00",dateStr03=year+"/"+month+"/"+(day+1)+" 10:00:00",currentTen=new Date(dateStr01).getTime(),currentFourteen=new Date(dateStr02).getTime(),nextTen=new Date(dateStr03).getTime(),diff=0;interval(validStartTime,currentTen,currentFourteen,nextTen,validEndTime)},error:function(){requestMsg("请求失败")}}),$.ajax({type:"post",url:"/fanbei-web/superCouponList",success:function success(data){self.couponContent=eval("("+data+")"),self.couponContent=self.couponContent.data,console.log(self.couponContent)},error:function(){requestMsg("请求失败")}})},buyNow:function(e){var t=this;window.location.href=t.content.notifyUrl+'&params={"goodsId":"'+e+'"}'},ruleClick:function(){$(".mask").show(),$(".rule").show()},maskClick:function(){$(".mask").hide(),$(".rule").hide()},couponClick:function(e){var t=this,n=t.couponContent.couponInfoList[e].couponId,r=t.couponContent.userName;t.content.currentTime<t.content.validStartTime+36e6?requestMsg("活动未开始，请稍候！"):t.content.currentTime>t.content.validEndTime?requestMsg("活动已结束！"):$.ajax({url:"/fanbei-web/pickCoupon",type:"POST",dataType:"JSON",data:{couponId:n,userName:r},success:function(e){if(e.success)requestMsg("优惠劵领取成功！");else{var t=e.data.status;"USER_NOT_EXIST"==t&&(window.location.href=e.url),"OVER"==t&&requestMsg("优惠券个数超过最大领券个数"),"MORE_THAN"==t&&requestMsg("已抢完，请等下一场！")}},error:function(){requestMsg("请求失败")}})},txtFix:function(e){return function(e,t){for(var n=0,r=0;r<e.length;r++){var i=e.charAt(r);if(encodeURI(i).length>2?n+=1:n+=.5,n>=t){var o=n==t?r+1:r;return e.substr(0,o)}}}(e,20)}}});
//# sourceMappingURL=../../_srcmap/activity/07/robCoupon.js.map
