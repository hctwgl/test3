"use strict";function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function AutoScroll(t,a){$(t).find("ul:first").animate({marginTop:a},500,function(){$(this).css({marginTop:"0"}).find("li:first").appendTo(this)})}function goUp(){$("#shadow").css("display","block"),$("#getPrize").slideDown(),$("#allToy").css("z-index",300),$("#allToy .gotoTop").css("transform","rotate(180deg)")}function goDown(){$("#shadow").css("display","none"),$("#getPrize").slideUp(),$("#allToy").css("z-index",150),$("#allToy .gotoTop").css("transform","rotate(0deg)")}var _createClass=function(){function t(t,a){for(var i=0;i<a.length;i++){var n=a[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(a,i,n){return i&&t(a.prototype,i),n&&t(a,n),a}}(),userName="";getInfo().userName&&(userName=getInfo().userName);var chance=[],isLogin=void 0,isShow=void 0;$.ajax({url:"/fanbei-web/initGame.htm",type:"post",success:function success(data){if(data=eval("("+data+")"),console.log(data),data.success){isLogin=data.data.isLogin,$("#chance").html("您还有"+data.data.chanceCount+"次机会"),chance=data.data.chanceCodes.split(","),data.data.item1Count>0&&($("#toys").find("img").eq(0).attr("src","https://fs.51fanbei.com/h5/app/activity/06/ni_boll5.png").css("width","61%"),$("#toys").find("span").eq(0).html(data.data.item1Count)),data.data.item2Count>0&&($("#toys").find("img").eq(1).attr("src","https://fs.51fanbei.com/h5/app/activity/06/ni_boll2.png").css("width","61%"),$("#toys").find("span").eq(1).html(data.data.item2Count)),data.data.item3Count>0&&($("#toys").find("img").eq(2).attr("src","https://fs.51fanbei.com/h5/app/activity/06/ni_boll6.png").css("width","61%"),$("#toys").find("span").eq(2).html(data.data.item3Count)),data.data.item4Count>0&&($("#toys").find("img").eq(3).attr("src","https://fs.51fanbei.com/h5/app/activity/06/ni_boll1.png").css("width","61%"),$("#toys").find("span").eq(3).html(data.data.item4Count)),data.data.item5Count>0&&($("#toys").find("img").eq(4).attr("src","https://fs.51fanbei.com/h5/app/activity/06/ni_boll8.png").css("width","61%"),$("#toys").find("span").eq(4).html(data.data.item5Count));for(var con="",i=0;i<data.data.awardList.length;i++)con+='<li>\n                <div class="personImg" style="background-image:url(\''+data.data.awardList[i].avatar+"')\"></div>\n                <h2><span>"+data.data.awardList[i].userName+"</span><span>"+data.data.awardList[i].msg+"</span></h2></li>";$(".awardList").html(con);for(var _con="",_i=0;_i<data.data.entityAwardList.length;_i++)_con+='<li>\n                <div class="personImg" style="background-image:url(\''+data.data.entityAwardList[_i].avatar+"')\"></div>\n                <h2><span>"+data.data.entityAwardList[_i].userName+"</span><span>"+data.data.entityAwardList[_i].msg+"</span></h2></li>";if($(".entityAwardList").html(_con),"Y"==data.data.isFinish&&($("#allToy").find("h3").html("五娃已集齐，请静等开奖！"),$("#getPrize h4").html("618活动抽奖获奖名单"),data.data.gmt_open))if($("#dollRoll").show(),"N"==data.data.isAward){var time=0;window.setInterval(function(){time+=1e3;var t,a,i,n,e,s,o=data.data.gmtOpen-data.data.gmtCurrent-time,l=parseInt(o/1e3),c=parseInt(l/3600),r=parseInt(l%3600/60),d=l%3600%60;c<10?(t="0",a=c):(c=c.toString(),t=c.slice(0,1),a=c.slice(1,2)),r<10?(i="0",n=r):(r=r.toString(),i=r.slice(0,1),n=r.slice(1,2)),d<10?(e="0",s=d):(d=d.toString(),e=d.slice(0,1),s=d.slice(1,2)),$(".countDown").find("span").eq(0).html(t),$(".countDown").find("span").eq(1).html(a),$(".countDown").find("span").eq(3).html(i),$(".countDown").find("span").eq(4).html(n),$(".countDown").find("span").eq(6).html(e),$(".countDown").find("span").eq(7).html(s)},1e3)}else"L"==data.data.awardInfo.type?($("#getPrize h4").html("恭喜您获得幸运大奖！"),$("#getPrize h5").html("奖项已发送至:我的-抵用券")):"Y"==data.data.awardInfo.type&&($("#getPrize h4").html("恭喜您获得实物大奖！"),"Y"==data.data.isSubmitContacts?$("#getPrize h5").html("奖项已发送至您的收货地址"):$("#getPrize h5").html("请提交资料"))}}});var game=function(){function t(a,i){_classCallCheck(this,t),this.init={num:-a,time:i},this.num=-a,this.time=i,$("#playBtn").click(this.claw.bind(this))}return _createClass(t,[{key:"start",value:function(){var t=this;this.reset(),this.run(),clearTimeout(this.Countdown),this.Countdown=setTimeout(function(){"No"!=isShow&&t.alertMsg("end")},2e4)}},{key:"run",value:function(){function t(){a.num>=0&&(a.num=-8.25,$("#scroll").animate({marginLeft:a.num+"rem"},0,"linear")),a.num=(Math.round(1e3*a.num)+1650)/1e3,$("#scroll").animate({marginLeft:a.num+"rem"},1e3,"linear",function(){t()})}this.doll();var a=this;t()}},{key:"reset",value:function(){$("#scroll").animate({marginLeft:this.init.num+"rem"},0,"linear"),$("#claw").css("backgroundImage","url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw1.png)"),this.num=this.init.num,this.time=this.init.time,clearInterval(this.timeStart),this.timeStart=setInterval(function(){this.time<=0?this.time=0:this.time-=1,$("#time").html(this.time+"秒")}.bind(this),1e3)}},{key:"doll",value:function(){for(var t=[1,2,3,4,5,1,2,3,4,5],a="",i=0;i<t.length;i++)a+='<span data-prop="'+t[i]+'" class="doll"><div class="doll-main" style="background-image: url(\'https://fs.51fanbei.com/h5/app/activity/06/ni_boll'+t[i]+".png')\"></div></span>";$("#scroll").html(a)}},{key:"alertMsg",value:function(t,a){isShow="No";var i={result:"N",code:chance[1]};"claw"==t&&(i={result:"Y",item:a,code:chance[1]}),$.ajax({url:"/fanbei-web/submitGameResult",type:"post",data:i,success:function(t){console.log(t)}}),$("#shadow").show(),$("#startBtn").show()}},{key:"claw",value:function(){var t=this,a=$("#claw").offset().left;$(".button").attr("disabled","disabled"),$("#claw").animate({top:"-.5rem"},1500,function(){$(".doll").each(function(){var i=$(this),n=i.offset().left;if(n>a-10&&n<a+35){var e=i.attr("data-prop");console.log("ok"),Math.floor(10*Math.random()+1)>0&&($("#claw").css("backgroundImage","url(https://fs.51fanbei.com/h5/app/activity/06/ni_claw2.png)"),i.find(".doll-main").css({position:"absolute",left:"2.47rem"}).animate({top:"-2.2rem"},800,function(){$(".doll[data-prop="+e+"]").css("visibility","hidden"),t.alertMsg("claw",e)}))}}),$("#claw").animate({top:"-2rem"},1e3,function(){$(".button").removeAttr("disabled")})})}}]),t}(),sixGame=new game(16.5,20);sixGame.run(),$("#startBtn").click(function(){"Y"==isLogin?chance.length<=1?$("#shadow").show():(sixGame.start(),$(this).hide(),console.log(chance)):window.location.href="/fanbei-web/opennative?name=APP_LOGIN"}),$("#shadow").click(function(){$(this).hide(),$(".alert").hide()}),$("#rule").click(function(){$("#rules").css("display","block"),$("#shadow").show()}),$(".closeRules").click(function(){$("#rules").css("display","none"),$("#shadow").hide()}),$(document).ready(function(){setInterval('AutoScroll(".roll01","-1rem")',1e3),setInterval('AutoScroll(".roll02","-.55rem")',1e3)}),$(function(){var t=1;$("#allToy .gotoTop").click(function(){1==t?(goUp(),t=0):(goDown(),t=1)}),$("#shadow").click(function(){goDown(),t=1})});
//# sourceMappingURL=../../_srcmap/activity/06/game.js.map
