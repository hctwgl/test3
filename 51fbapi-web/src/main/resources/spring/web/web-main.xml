<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:util="http://www.springframework.org/schema/util"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:task="http://www.springframework.org/schema/task"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:mvc="http://www.springframework.org/schema/mvc"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd 
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd 
        http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

	<context:annotation-config />
	<task:annotation-driven /> 
	<mvc:annotation-driven/>
	<mvc:default-servlet-handler/>
	
	<context:component-scan base-package="com.ald.fanbei.api.biz.third.util" />
	<context:component-scan base-package="com.ald.fanbei.api.web.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.web.listener" />
	<context:component-scan base-package="com.ald.fanbei.api.web.api" />
	<context:component-scan base-package="com.ald.fanbei.api.web.common.impl" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.util" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.service.impl" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.rule.service.impl" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.common" />
	<context:component-scan base-package="com.ald.fanbei.api.web.h5.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.web.third.controller" />
	
	
	<!-- velocity configuration -->
	<bean id="velocityConfigurer"
		class="org.springframework.web.servlet.view.velocity.VelocityConfigurer"
		p:resourceLoaderPath="/WEB-INF/views/">
		<property name="configLocation" value="classpath:props/velocity.properties">
		</property>
	</bean>

	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.velocity.VelocityLayoutViewResolver"
		p:cache="true" p:suffix=".vm" p:layoutUrl="layout/default.vm"
		p:prefix="screen/" p:dateToolAttribute="dateTool"
		p:numberToolAttribute="numberTool"
		p:contentType="text/html;charset=UTF-8" p:allowSessionOverride="false"
		p:allowRequestOverride="false" p:exposeSessionAttributes="false"
		p:exposeRequestAttributes="false" p:exposeSpringMacroHelpers="true"
		p:redirectHttp10Compatible="false">
		<property name="attributesMap">
			<map>
				<entry key="stringUtils">
					<bean class="org.apache.commons.lang.StringUtils" />
				</entry>
			</map>
		</property>
	</bean>
	
	<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
		<property name="messageConverters">
			<list>
				<bean class="org.springframework.http.converter.StringHttpMessageConverter">
					<property name="supportedMediaTypes">
						<list>
							<bean class="org.springframework.http.MediaType">
								  <constructor-arg value="text" />
                    				<constructor-arg value="plain" />
                    				<constructor-arg value="UTF-8" />
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>
	
	<bean id="beforeLoginApiList" class="java.util.ArrayList">
		<constructor-arg>
			<list>
				<value>/user/login</value>
				<value>/user/getVerifyCode</value>
				<value>/user/setRegisterPwd</value>
				<value>/user/checkVerifyCode</value>
				<value>/user/resetPwd</value>
			</list>
		</constructor-arg>
	</bean>	
	
	<bean id="apiHandleMap" class="java.util.HashMap">
		<constructor-arg>
			<map key-type="java.lang.String">
			    
				<!-- user -->
				<entry key="/user/login" value-ref="loginApi" />
				<entry key="/user/getVerifyCode" value-ref="getVerifyCodeApi" />
				<entry key="/user/checkVerifyCode" value-ref="checkVerifyCodeApi" />
				<entry key="/user/setRegisterPwd" value-ref="setRegisterPwdApi" />
				<entry key="/user/resetPwd" value-ref="resetPwdApi" />
				<entry key="/user/getUserInfo" value-ref="getUserInfoApi" />
				<entry key="/user/logout" value-ref="logoutApi" />
				<entry key="/user/updateUserInfo" value-ref="updateUserInfoApi" />
				<entry key="/user/getSysMsgList" value-ref="getSysMsgListApi" />
				<entry key="/user/getMineInfo" value-ref="getMineInfoApi" />
				<entry key="/user/getMineCouponList" value-ref="getMineCouponListApi" />
				<entry key="/user/getCallCenterInfo" value-ref="getCallCenterInfoApi" />
				<entry key="/user/commitFeedback" value-ref="commitFeedbackApi" />
				<entry key="/user/getCouponList" value-ref="getCouponListApi" />
				<entry key="/user/pickCoupon" value-ref="pickCouponApi" />
				<entry key="/user/getSigninInfo" value-ref="getSigninInfoApi" />
				<entry key="/user/changeLoginPwd" value-ref="changeLoginPwdApi" />
				<entry key="/user/changeMobile" value-ref="changeMobileApi" />
				<entry key="/user/getInvitationInfo" value-ref="getInvitationInfoApi" />
				<entry key="/user/setPayPwd" value-ref="setPayPwdApi" />
				<entry key="/user/getPayPwdVerifyCode" value-ref="getPayPwdVerifyCodeApi" />
				<entry key="/user/checkPayPwdVerifyCode" value-ref="checkPayPwdVerifyCodeApi" />
				<entry key="/user/checkIdNumber" value-ref="checkIdNumberApi" />
				<entry key="/user/checkPayPwd" value-ref="checkPayPwdApi" />
				<entry key="/user/getEmailVerifyCode" value-ref="getEmailVerifyCodeApi" />
				<entry key="/user/changeEmail" value-ref="changeEmailApi" />
				<entry key="/user/getBankCardList" value-ref="getBankCardListApi" />
				<entry key="/user/deleteBankCard" value-ref="deleteBankCardApi" />
				
				
				<entry key="/user/signin" value-ref="signinApi" />

				<!-- goods -->
				<entry key="/goods/addFootMark" value-ref="addFootMarkerApi" />
				<entry key="/goods/getFootMarkList" value-ref="getFootMarkListApi" />
				<entry key="/goods/getHomeInfo" value-ref="getHomeInfoApi" />
				<entry key="/goods/getCateGoodsList" value-ref="getCateGoodsListApi" />
				<entry key="/goods/getCategoryList" value-ref="getCategoryListApi" />
				<entry key="/goods/getThirdGoodsList" value-ref="getThirdGoodsListApi" />
				
				<!-- 订单Order -->
				<entry key="/order/mobileCharge" value-ref="mobileChargeApi" />
				<entry key="/order/getOrderDetailInfo" value-ref="getOrderDetailInfoApi" />
				<entry key="/order/getOrderList" value-ref="getOrderListApi" />
				<entry key="/order/getOrderNoWithUser" value-ref="getOrderNoWithUserApi" />
				
				<!-- system模块 -->
				<entry key="/system/appUpgrade" value-ref="appUpgradeApi" /> 
				<entry key="/system/getSettingInfo" value-ref="getSettingInfoApi" /> 
				
				<!-- auth模块 -->
				<entry key="/auth/authFace" value-ref="authFaceApi" /> 
				<entry key="/auth/authRealname" value-ref="authRealnameApi" />
				<entry key="/auth/authContacts" value-ref="authContactsApi" />
				<entry key="/auth/authCredit" value-ref="authCreditApi" /> 
				<entry key="/auth/authZhima" value-ref="authZhimaApi" /> 
				
				<!-- borrow -->
				<entry key="/borrow/getBorrowHomeInfo" value-ref="getBorrowHomeInfoApi" /> 
				<entry key="/borrow/getCashConfirmInfo" value-ref="getCashConfirmInfoApi" /> 
				<entry key="/borrow/getConsumeConfirmInfo" value-ref="getConsumeConfirmInfoApi" />
				<entry key="/borrow/applyCash" value-ref="applyCashApi" />
				<entry key="/borrow/applyConsume" value-ref="applyConsumeApi" />
				<entry key="/bill/getMyBillHomeInfo" value-ref="getMyBillHomeInfoApi" />
				<entry key="/bill/getMyBillList" value-ref="getMyBillListApi" />
				<entry key="/bill/getBillDetailList" value-ref="getBillDetailListApi" />
				<entry key="/bill/getBillDetailInfo" value-ref="getBillDetailInfoApi" />
				<entry key="/repay/getRepaymentConfirmInfo" value-ref="getRepaymentConfirmInfoApi" />
				<entry key="/repay/submitRepayment" value-ref="submitRepaymentApi" />
				<entry key="/bill/getLimitDetailList" value-ref="getLimitDetailListApi" />
				
				<!-- <entry key="/auth/authBankcard" value-ref="authBankcardApi" /> 
				 -->
				
			</map>
		</constructor-arg>
	</bean>

	<bean id="springBeanContextUtil" class="com.ald.fanbei.api.common.util.SpringBeanContextUtil" /> 
	
	<bean id="healthCheck" class="com.ald.fanbei.api.biz.bo.common.HealthCheck"/>
	<!-- task job -->
	<task:scheduled-tasks>
		<task:scheduled ref="healthCheck" method="checkBizCache" cron="0 1/2 * * * *" />
	</task:scheduled-tasks>
	
</beans>