<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:util="http://www.springframework.org/schema/util"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:task="http://www.springframework.org/schema/task"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:mvc="http://www.springframework.org/schema/mvc"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd 
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd 
        http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

	<context:annotation-config />
	<task:annotation-driven />
	<mvc:annotation-driven />
	<mvc:default-servlet-handler />

	<context:component-scan base-package="com.ald.fanbei.api.biz.third.util" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.rebate" />
	<context:component-scan base-package="com.ald.fanbei.api.web.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.abtest.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.web.listener" />
	<context:component-scan base-package="com.ald.fanbei.api.web.api" />
	<context:component-scan base-package="com.ald.fanbei.api.web.h5.api" />
	<context:component-scan base-package="com.ald.fanbei.api.web.common.impl" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.util" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.kafka" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.service" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.service.boluome" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.rule.service.impl" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.common" />
	<context:component-scan base-package="com.ald.fanbei.api.web.h5.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.web.third.controller" />
	<context:component-scan base-package="com.ald.fanbei.api.web.apph5.controller" />
	
	<context:component-scan base-package="com.ald.fanbei.api.web.validator.bean" />
	<context:component-scan base-package="com.ald.fanbei.api.web.validator.intercept" />
	<context:component-scan base-package="com.ald.fanbei.api.biz.auth.executor" />
	<context:component-scan base-package="com.ald.fanbei.api.web.task" />

	<!-- velocity configuration -->
	<bean id="velocityConfigurer"
		class="org.springframework.web.servlet.view.velocity.VelocityConfigurer"
		p:resourceLoaderPath="/WEB-INF/views/">
		<property name="configLocation" value="classpath:props/velocity.properties">
		</property>
	</bean>

	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.velocity.VelocityLayoutViewResolver"
		p:cache="true" p:suffix=".vm" p:layoutUrl="layout/default.vm"
		p:prefix="screen/" p:dateToolAttribute="dateTool"
		p:numberToolAttribute="numberTool" p:contentType="text/html;charset=UTF-8"
		p:allowSessionOverride="false" p:allowRequestOverride="false"
		p:exposeSessionAttributes="false" p:exposeRequestAttributes="false"
		p:exposeSpringMacroHelpers="true" p:redirectHttp10Compatible="false">
		<property name="attributesMap">
			<map>
				<entry key="stringUtils">
					<bean class="org.apache.commons.lang.StringUtils" />
				</entry>
				<entry key="dateUtil">
					<bean class="com.ald.fanbei.api.common.util.DateUtil" />
				</entry>
				<entry key="priceUtil">
					<bean class="com.ald.fanbei.api.common.util.PriceUtil" />
				</entry>
				<entry key="jsonUtil">
					<bean class="com.ald.fanbei.api.common.util.JsonUtil" />
				</entry>
			</map>
		</property>
	</bean>


	<bean
		class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
		<property name="messageConverters">
			<list>
				<bean
					class="org.springframework.http.converter.StringHttpMessageConverter">
					<property name="supportedMediaTypes">
						<list>
							<bean class="org.springframework.http.MediaType">
								<constructor-arg value="text" />
								<constructor-arg value="plain" />
								<constructor-arg value="UTF-8" />
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean id="beforeLoginApiList" class="java.util.ArrayList">
		<constructor-arg>
			<list>
				<value>/user/login</value>
			</list>
		</constructor-arg>
	</bean>

	<bean id="apiHandleMap" class="java.util.HashMap">
		<constructor-arg>
			<map key-type="java.lang.String">

				<!-- user -->
				<entry key="/user/login" value-ref="loginApi" />
			</map>
		</constructor-arg>
	</bean>
	


	<!-- App内部H5接口 ,接口需要满足h5/**格式 -->
	<bean id="h5HandleMap" class="java.util.HashMap">
		<constructor-arg>
			<map key-type="java.lang.String">
				<!-- 贷款相关接口 -->
				<entry key="/h5/loan/applyLoan" value-ref="applyLoanApi" />
				<entry key="/h5/loan/confirmLoan" value-ref="confirmLoanApi" />
				<entry key="/h5/loan/getLoanHomeInfo" value-ref="getLoanHomeInfoApi" />
				<entry key="/h5/loan/loanConfirmPayment" value-ref="loanConfirmPaymentApi" />
				<entry key="/h5/loan/getLoanDecreasedAmount" value-ref="getLoanDecreasedAmountApi" />

				<entry key="/h5/loan/getLoanInfo" value-ref="getLoanInfoApi" />
				<entry key="/h5/loan/loanRepayPlan" value-ref="loanRepayPlanApi" />
				<entry key="/h5/loan/getLoanRepayments" value-ref="getLoanRepaymentsApi" />
				<entry key="/h5/loan/getWhiteLoanProtocol" value-ref="getWhiteLoanProtocolApi" />
				<!-- 白领贷业务接口 -->
				<entry key="/h5/whitecollar/dredgeWhiteCollarLoan" value-ref="dredgeWhiteCollarLoanApi" />
				<entry key="/h5/whitecollar/getUserAuthStatus" value-ref="getUserAuthStatusApi" />

				<!--回收业务接口-->
				<entry key="/h5/recycle/borrowRecycleRecord" value-ref="borrowRecycleRecordApi" />
				<entry key="/h5/recycle/borrowRecycleDetail" value-ref="borrowRecycleDetailApi" />
				<entry key="/h5/recycle/borrowRecycleHome" value-ref="borrowRecycleHomeInfoApi" />
				<entry key="/h5/recycle/borrowRecycleStatus" value-ref="borrowRecycleStatusApi" />
				<entry key="/h5/recycle/recycleRepayDo" value-ref="recycleRepayDoApi" />
				<entry key="/h5/recycle/getUserBankList" value-ref="getUserBankListApi" />
				<entry key="/h5/recycle/borrowFinanceHome" value-ref="borrowFinanceHomeApi" />
				<entry key="/h5/recycle/borrowRecycleExplain" value-ref="borrowRecycleExplainApi" />
				<entry key="/h5/recycle/getRecycleProtocol" value-ref="getRecycleProtocolApi" />
				<!-- 回收业务接口 -->
				<entry key="/h5/recycle/applyBorrowRecycleCash" value-ref="applyBorrowRecycleCashApi" />

				<!-- 边逛边赚 -->
				<entry key="/h5/reward/getRewardHomeInfo" value-ref="getRewardHomeInfoApi" />
				<entry key="/h5/reward/getFinishedTask" value-ref="getFinishedTaskApi" />
				<entry key="/h5/reward/getRewardDetail" value-ref="getRewardDetailApi" />
				<entry key="/h5/reward/getWithdrawDetail" value-ref="getWithdrawDetailApi" />
				<entry key="/h5/reward/getExtractMoney" value-ref="getExtractMoneyApi" />
				<entry key="/h5/reward/getReceiveReward" value-ref="getReceiveRewardApi" />
				<entry key="/h5/reward/getSignRemind" value-ref="getSignRemindApi" />
				<entry key="/h5/reward/doFinishTask" value-ref="doFinishTaskApi" />
				<entry key="/h5/reward/doShareTask" value-ref="doShareTaskApi" />
				<entry key="/h5/reward/doPushTask" value-ref="doPushTaskApi" />

				<entry key="/third/xgxy/v1/bankCardBind" value-ref="dsedApplyBindBankCardMsgApi"/>
				<entry key="/third/xgxy/v1/smsCodeSubmit" value-ref="dsedsmsCodeSubmitApi"/>
				<entry key="/third/xgxy/v1/getSmsCode" value-ref="dsedResendCodeApi"/>

				<entry key="/third/xgxy/v1/getAddressList" value-ref="getUserContactsInfoApi"/>

				<entry key="/third/xgxy/v1/comfirmBorrow" value-ref="dsedApplyLoanApi" />
				<entry key="/third/xgxy/v1/preFinish" value-ref="dsedLoanAllRepayDoApi" />
				<entry key="/third/xgxy/v1/repayComfirm" value-ref="dsedLoanRepayDoApi" />
				<entry key="/third/xgxy/v1/getDecreasedAmount" value-ref="getDsedLoanDecreasedAmountApi" />
				<entry key="/third/xgxy/v1/getBorrowInfo" value-ref="dsedGetLoanInfoApi" />
				<entry key="/third/xgxy/v1/getRealPeriod" value-ref="dsedLoanTotalPeriodsApi" />
				<entry key="/third/xgxy/v1/getBorrowFeeDetail" value-ref="dsedLoanDetailApi" />
				<entry key="/third/xgxy/v1/syncUserInfo" value-ref="dsedSyncUserInfoApi" />
				<entry key="/third/xgxy/v1/getSmsCode" value-ref="dsedResendCodeApi" />
				<!-- 支付相关接口 -->
				<entry key="/h5/pay/recycleQuickPaymentResendCode" value-ref="recycleQuickPaymentResendCodeApi" />
				<entry key="/h5/pay/recycleConfirmPayment" value-ref="recycleConfirmPaymentApi" />
			</map>
		</constructor-arg>
	</bean>
	

	<!-- 灰度测试 URL-->
	<bean id="abTestHandleList" class="java.util.ArrayList">
		<constructor-arg>
			<list>
				<value>/goods/getHomeInfoFront</value>
				<value>/user/loginFront</value>
			</list>
		</constructor-arg>
	</bean>

	<bean id="springBeanContextUtil" class="com.ald.fanbei.api.common.util.SpringBeanContextUtil" />
	<bean  class="com.ald.fanbei.api.web.application.SpringInit" />

	<bean id="healthCheck" class="com.ald.fanbei.api.biz.bo.common.HealthCheck" />
	<!-- task job -->
	<task:scheduled-tasks>
		<task:scheduled ref="healthCheck" method="checkBizCache"
			cron="0 1/2 * * * *" />
	</task:scheduled-tasks>
	
	<!-- 拦截器链 -->
	<bean id="interceptorChain" class="com.ald.fanbei.api.web.chain.impl.InterceptorChain">
		<property name="interceptors">
			<list>
				<ref bean="dsedValidationInterceptor"/>
			</list>
		</property>
	</bean>

</beans>
