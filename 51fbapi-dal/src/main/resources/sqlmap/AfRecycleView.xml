<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfRecycleViewDao">

    <sql id="commSqlField">
		id,is_delete,gmt_create,gmt_modified,uid,`type`,qty
	</sql>

    <!-- 添加订单-->
    <insert id="addRecycleView" parameterType="AfRecycleQuery" keyProperty="rid" useGeneratedKeys="true">
		INSERT INTO
			af_recycle_view
			(
				gmt_create,
				gmt_modified,
				qty,
				user_id,
				`type`
			)
		VALUES
		    (
				NOW(),
				NOW(),
				1,
				#{userId},
				#{type}
			)
	</insert>

    <!-- 查找单个某个用户的访问记录-->
    <select id="getRecycleViewByUid" parameterType="AfRecycleViewQuery" resultType="AfRecycleViewDo">
        SELECT
        <include refid="commSqlField"/>
        FROM
        af_recycle_view
        WHERE
        is_delete = 0
        AND user_id = #{userId} AND `type` = #{type}
        LIMIT 1
    </select>

    <!-- 更新单个某个用户的访问记录-->
    <select id="updateRecycleView" parameterType="AfRecycleViewQuery">
		UPDATE
			af_recycle_view
		SET
			gmt_modified = now(),qty = qty + 1
		WHERE
			user_id = #{userId} AND `type` = #{type}
	</select>

</mapper>