<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- af_task_coin_change_proportion表 -->
<mapper namespace="com.ald.fanbei.api.dal.dao.AfTaskCoinChangeProportionDao">
    
    <!--基本的sql查询字段 公共引用...-->
    <sql id="queryFields">
        id rid,gmt_create,gmt_modified,change_date,change_proportion 
    </sql>
    
    <!-- 基本的sql查询条件公共引用 -->
    <sql id="commonCondition">
    	WHERE is_delete = 0
        <if test="rid !=null">
            AND id  = #{rid,jdbcType=INTEGER}
        </if>
        <if test="gmtCreate !=null">
            AND gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}
        </if>
        <if test="gmtModified !=null">
            AND gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}
        </if>
        <if test="changeDate !=null">
            AND change_date = #{changeDate,jdbcType=TIMESTAMP}
        </if>
        <if test="changeProportion != null and changeProportion != ''">
            AND change_proportion = #{changeProportion,jdbcType=DECIMAL}
        </if>
    </sql>

       <select id="getYesterdayProportion" resultType="com.ald.fanbei.api.dal.domain.AfTaskCoinChangeProportionDo">
        SELECT
        <include refid="queryFields" />
        FROM af_task_coin_change_proportion
        WHERE is_delete = 0 AND TO_DAYS(change_date) - TO_DAYS(now()) = 1
        LIMIT 0,1
    </select>

</mapper>
