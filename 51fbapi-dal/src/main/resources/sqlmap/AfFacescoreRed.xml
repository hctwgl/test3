<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- af_facescore_red表 -->
<mapper namespace="com.ald.fanbei.api.dal.dao.AfFacescoreRedDao">

	<!--基本的sql查询字段 公共引用... -->
	<sql id="queryFields">
		id rid,amount,imageurl,config_id
	</sql>

	<!-- 基本的sql查询条件公共引用 -->
	<sql id="commonCondition">
		WHERE is_delete = 0
		<if test="rid !=null">
			AND id = #{rid,jdbcType=INTEGER}
		</if>
		<if test="amount != null and amount != ''">
			AND amount = #{amount,jdbcType=DECIMAL}
		</if>
		<if test="imageurl != null and imageurl != ''">
			AND imageurl = #{imageurl,jdbcType=VARCHAR}
		</if>
		<if test="configId != null and configId != ''">
			AND config_id = #{configId,jdbcType=INTEGER}
		</if>
	</sql>


	<insert id="saveRecord" parameterType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo"
		keyProperty="rid">
		<selectKey resultType="java.lang.Long" keyProperty="rid"
			order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>

		INSERT INTO af_facescore_red
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="amount != null">
				amount,
			</if>
			<if test="imageurl != null">
				imageurl,
			</if>
			<if test="configId != null">
				config_id,
			</if>
		</trim>

		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="amount != null">
				#{amount,jdbcType=DECIMAL},
			</if>
			<if test="imageurl != null">
				#{imageurl,jdbcType=VARCHAR},
			</if>
			<if test="configId != null">
				#{configId,jdbcType=INTEGER},
			</if>
		</trim>
	</insert>
	<insert id="addRed" useGeneratedKeys="true" keyProperty="rid"
		parameterType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo">
		INSERT INTO af_facescore_red
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="amount != null">
				amount,
			</if>
			<if test="imageurl != null">
				imageurl,
			</if>
			<if test="configId != null">
				config_id,
			</if>
		</trim>

		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="amount != null">
				#{amount,jdbcType=DECIMAL},
			</if>
			<if test="imageurl != null">
				#{imageurl,jdbcType=VARCHAR},
			</if>
			<if test="configId != null">
				#{configId,jdbcType=INTEGER},
			</if>
		</trim>
	</insert>
	<update id="updateById" parameterType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo">
		UPDATE af_facescore_red
		<set>
			<if test="amount != null and amount != '' ">
				amount = #{amount,jdbcType=DECIMAL},
			</if>
			<if test="imageurl != null and imageurl != '' ">
				imageurl = #{imageurl,jdbcType=VARCHAR},
			</if>
			<if test="configId != null and configId != '' ">
				config_id = #{configId,jdbcType=INTEGER}
			</if>
		</set>
		WHERE is_delete = 0 AND id = #{rid ,jdbcType=BIGINT}
	</update>

	<select id="getById" resultType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo">
		SELECT
		<include refid="queryFields" />
		FROM af_facescore_red
		WHERE is_delete = 0 AND id=#{rid ,jdbcType=BIGINT}
		LIMIT 0,1
	</select>

	<select id="getByCommonCondition" resultType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo"
		parameterType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo">
		SELECT
		<include refid="queryFields" />
		FROM af_facescore_red
		<include refid="commonCondition" />
		limit 0,1
	</select>

	<select id="getListByCommonCondition" resultType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo"
		parameterType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo">
		SELECT
		<include refid="queryFields" />
		FROM af_facescore_red
		<include refid="commonCondition" />
	</select>

	<select id="getImageUrlByUserId" resultType="com.ald.fanbei.api.dal.domain.AfFacescoreRedDo"
		parameterType="java.lang.Long">
		SELECT
		<include refid="queryFields" />
		FROM af_facescore_red
		where id =
		(
		select max(red_id)
		from af_facescore_user_red
		where user_id = #{userId}
		)
	</select>
	<select id="getAllRedImg" resultType="com.ald.fanbei.api.dal.domain.AfFacescoreImgDo">
	 select id as rid,url as url from af_facescore_img  where is_delete = 0
	</select>
</mapper>
