<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfUserDao">
	<sql id="queryAllFields">
		id rid,gmt_create,gmt_modified,user_name,password,salt,gender,nick,avata,real_name,
		mobile,email,birthday,province,city,county,address,recommend_id,fail_count,vip_level,
		recommend_code
	</sql>

	<insert id="addUser" parameterType="AfUserDo" keyProperty="rid" useGeneratedKeys="true">
		INSERT INTO af_user
		(
			gmt_create,
			gmt_modified,
			user_name,
			password,
			salt,
			nick,
			mobile,
			recommend_id,
			recommend_code
		)
		VALUES(
			NOW(),
			NOW(),
			#{userName},
			#{password},
			#{salt},
			#{nick},
			#{mobile},
			#{recommendId},
			#{recommendCode}
		)
	</insert>
	
	<select id="getUserById" resultType="AfUserDo">
		SELECT
			<include refid="queryAllFields" />
		FROM
			af_user
		WHERE
			is_delete = 0
		AND
			id = #{userId}
	</select>
	
	<select id="getUserByUserName" resultType="AfUserDo">
		SELECT
			<include refid="queryAllFields" />
		FROM
			af_user
		WHERE
			is_delete = 0
		AND
			userName = #{userName}
	</select>

	<update id="updateUser" parameterType="AfUserDo">
		UPDATE
			af_user
		SET
			gmt_modified = NOW()
		<if test="userName != null">
			,user_name = #{userName}
		</if>
		<if test="password != null">
			,password = #{password}
		</if>
		<if test="salt != null">
			,salt = #{salt}
		</if>
		<if test="gender != null">
			,gender = #{gender}
		</if>
		<if test="nick != null">
			,nick = #{nick}
		</if>
		<if test="avata != null">
			,avata = #{avata}
		</if>
		<if test="realName != null">
			,real_name = #{realName}
		</if>
		<if test="mobile != null">
			,mobile = #{mobile}
		</if>
		<if test="email != null">
			,email = #{email}
		</if>
		<if test="birthday != null">
			,birthday = #{birthday}
		</if>
		<if test="province != null">
			,province = #{province}
		</if>
		<if test="city != null">
			,city = #{city}
		</if>
		<if test="county != null">
			,county = #{county}
		</if>
		<if test="address != null">
			,address = #{address}
		</if>
		<if test="recommendId != null">
			,recommend_id = #{recommendId}
		</if>
		<if test="failCount != null">
			,fail_count = #{failCount}
		</if>
		<if test="vipLevel != null">
			,vip_level = #{vipLevel}
		</if>
		<if test="recommendCode != null">
			,recommend_code = #{recommendCode}
		</if>
		WHERE
			id = #{rid}
	</update>

</mapper>