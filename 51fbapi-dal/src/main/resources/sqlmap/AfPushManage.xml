<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ald.fanbei.api.dal.dao.AfPushManageDao" >
  <resultMap id="BaseResultMap" type="AfPushManageDo" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="is_delete" property="isDelete" jdbcType="TINYINT" />
    <result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
    <result column="gmt_send" property="gmtSend" jdbcType="TIMESTAMP" />
    <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="content_push" property="contentPush" jdbcType="VARCHAR" />
    <result column="parameter" property="parameter" jdbcType="VARCHAR" />
    <result column="picture_push_url" property="picturePushUrl" jdbcType="VARCHAR" />
    <result column="notification_delivery_num" property="notificationDeliveryNum" jdbcType="INTEGER" />
    <result column="message_delivery_num" property="messageDeliveryNum" jdbcType="INTEGER" />
    <result column="notification_open_num" property="notificationOpenNum" jdbcType="INTEGER" />
    <result column="message_open_num" property="messageOpenNum" jdbcType="INTEGER" />
    <result column="user_type" property="userType" jdbcType="VARCHAR" />
    <result column="group_user_id" property="groupUserId" jdbcType="INTEGER" />
    <result column="group_user_name" property="groupUserName" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="jump_type" property="jumpType" jdbcType="VARCHAR" />
    <result column="jump_url" property="jumpUrl" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="system_type" property="systemType" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, is_delete, gmt_create, gmt_send, gmt_modified, type, title, content_push, parameter,
    picture_push_url, notification_delivery_num, message_delivery_num, notification_open_num,
    message_open_num, user_type, group_user_id, group_user_name, status,message_msg_id,notify_msg_id,jump_type,jump_url,system_type,user_name
  </sql>
  <select id="getById" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from af_push_manage
    where id = #{id,jdbcType=BIGINT}
    AND is_delete = 0
  </select>
  <update id="updateById" parameterType="AfPushManageDo" >
    update af_push_manage
    <set >
      <if test="type != null and type == 1">
        message_open_num = message_open_num +1
      </if>
      <if test="type != null and type == 2">
        notification_open_num = notification_open_num + 1
      </if>
      <if test="type != null and type == 3">
        message_open_num = message_open_num +1,
        notification_open_num = notification_open_num + 1
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
</mapper>