<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfLoanSupermarketDao">
	<sql id="queryFields">
		id,lsm_no,icon_url,gmt_create,gmt_modified,create_user_id,modify_user_id,lsm_name,lsm_intro,link_url,label,order_no,status,is_delete,market_point,lsm_secret_key,is_union_login,money_min,money_max,time_min,time_max,pay_method,apply_process,apply_condition,need_material,fast_lend_time,lend_rate,money,time,time_unit,slogan
	</sql>

	<insert id="addLoanSupermarket" parameterType="AfLoanSupermarketDo" useGeneratedKeys="true" keyProperty="id">
			INSERT INTO af_loan_supermarket(lsm_no , icon_url , gmt_create , gmt_modified , create_user_id , modify_user_id , lsm_name , lsm_intro , link_url , label , order_no , status ,is_delete)
			VALUES (
	    		#{lsmNo},
	    		#{iconUrl},
	    		NOW(),
	    		NOW(),
	    		#{createUserId},
	    		#{modifyUserId},
	    		#{lsmName},
	    		#{lsmIntro},
	    		#{linkUrl},
	    		#{label},
	    		#{orderNo},
	    		#{status},
	    		#{isDelete},
			)
	</insert>
	
	<update id="updateLoanSupermarket" parameterType="AfLoanSupermarketDo" >
		UPDATE af_loan_supermarket SET gmt_modified = NOW()
			<if test="lsmNo != null">
    			,lsm_no=#{lsmNo}
			</if>
			<if test="iconUrl != null">
    			,icon_url=#{iconUrl}
			</if>
			<if test="createUserId != null">
    			,create_user_id=#{createUserId}
			</if>
			<if test="modifyUserId != null">
    			,modify_user_id=#{modifyUserId}
			</if>
			<if test="lsmName != null">
    			,lsm_name=#{lsmName}
			</if>
			<if test="lsmIntro != null">
    			,lsm_intro=#{lsmIntro}
			</if>
			<if test="linkUrl != null">
    			,link_url=#{linkUrl}
			</if>
			<if test="label != null">
    			,label=#{label}
			</if>
			<if test="orderNo != null">
    			,order_no=#{orderNo}
			</if>
			<if test="status != null">
    			,status=#{status}
			</if>
			<if test="isDelete != null">
    			,is_delete=#{isDelete}
			</if>
		WHERE id = #{id}
	</update>
	
	<select id="getLoanSupermarketListOrderNo" resultType="AfLoanSupermarketDo">
		SELECT
		<include refid="queryFields" />
		FROM
		af_loan_supermarket
		WHERE
		is_delete = 0
		AND
		status = 1
		ORDER BY
		order_no ASC
		LIMIT
		#{start},20
	</select>
	
	<select id="getLoanSupermarketByLsmNo" resultType="AfLoanSupermarketDo">
		SELECT
		<include refid="queryFields" />
		FROM
		af_loan_supermarket
		WHERE
		is_delete = 0
		AND
		status = 1
		and
		lsm_no = #{lsmNo}
		ORDER BY
		id desc
		LIMIT 1
	</select>

	<select id="getLoanSupermarketByLabel" resultType="AfLoanSupermarketDo" parameterType="java.lang.String">
		SELECT
		<include refid="queryFields" />
		FROM
		af_loan_supermarket
		WHERE
		is_delete = 0
		AND
		status = 1
		AND
		label = #{label}
		<if test="systemType != null and systemType == 1">
			AND system in (1,3)
		</if>
		<if test="systemType != null and systemType == 2">
			AND system in (2,3)
		</if>
		<if test="systemType != null and systemType == 3">
			AND system = '3'
		</if>
		ORDER BY order_no ASC
	</select>
	
	
</mapper>