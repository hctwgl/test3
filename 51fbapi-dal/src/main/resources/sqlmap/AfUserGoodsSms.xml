<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfUserGoodsSmsDao">
	
	<sql id="smsSqlField">
		id rid,is_delete,gmt_create,gmt_modified,goods_name,user_id,goods_id
	</sql>
	
	<select id="selectByGoodsIdAndUserId" parameterType="AfUserGoodsSmsDo" resultType="AfUserGoodsSmsDo">
		select <include refid="smsSqlField" /> FROM  af_user_goods_sms where is_delete = 0 and goods_id = #{goodsId} and user_id = #{userId}
		and CAST(CAST(gmt_create AS DATE)AS DATETIME) = date_sub(CAST(CAST(SYSDATE()AS DATE)AS DATETIME), interval 1 day)
	</select>

	<select id="selectBookingByGoodsIdAndUserId" parameterType="AfUserGoodsSmsDo" resultType="AfUserGoodsSmsDo">
		select <include refid="smsSqlField" /> FROM  af_user_goods_sms where is_delete = 0 and goods_id = #{goodsId} and user_id = #{userId}
		and CAST(CAST(gmt_create AS DATE)AS DATETIME) = CAST(CAST(SYSDATE()AS DATE)AS DATETIME)
	</select>

	<insert id="insertByGoodsIdAndUserId" parameterType="AfUserGoodsSmsDo" useGeneratedKeys="true" keyProperty="rid">
		INSERT INTO
			af_user_goods_sms
			(
				is_delete,
				gmt_create,
				gmt_modified,
				goods_name,
				goods_id,
				user_id
			)
			VALUES(
				#{isDelete},
				NOW(),
				NOW(),
				#{goodsName},
				#{goodsId},
				#{userId}
			)
	</insert>

</mapper>