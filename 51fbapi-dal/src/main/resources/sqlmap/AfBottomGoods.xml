<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfBottomGoodsDao">

	<resultMap id="BottomGoodsDtoRM" type="com.ald.fanbei.api.dal.domain.dto.AfBottomGoodsDto">
		<id property="id" column="id"/>
		<result property="sort" column="sort"/>
		<association property="goodsDo" javaType="com.ald.fanbei.api.dal.domain.AfGoodsDo">
			<id property="rid" column="goods_id"/>
			<result property="goodsIcon" column="goods_icon"/>
			<result property="name" column="goods_name"/>
			<result property="saleAmount" column="sale_amount"/>
		</association>
	</resultMap>

	<select id="findGoodsByPageFlag" resultMap="BottomGoodsDtoRM">
		SELECT g.id goods_id, g.goods_icon, g.name goods_name, g.sale_amount, bg.id, bg.sort
		FROM af_bottom_goods bg, af_bottom_goods_page p, af_goods g
		WHERE g.is_delete = 0 AND bg.is_delete = 0 AND p.is_delete = 0 AND p.is_disable = 0
			AND bg.page_id = p.id AND bg.goods_id = g.id AND p.page_flag = #{pageFlag}
		ORDER BY bg.sort DESC, bg.gmt_create DESC
	</select>
</mapper>