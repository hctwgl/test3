<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ald.fanbei.api.dal.dao.AfResourceDao">
	<sql id="queryAllFields">

		id
		rid,gmt_create,gmt_modified,creator,modifier,data_type,type,type_desc,name,value,description,
		sec_type,value_1,value_2,value_3,value_4,sort,pic1,pic2
	</sql>
	<sql id="queryManyAllFields">

		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r1.type_desc,r1.name,r1.value,r1.description,
		r2.sec_type,r1.value_1,r1.value_2,r1.value_3,r2.value_4,r1.sort
	</sql>
	<sql id="queryManyAllFieldsOneTwo">
		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r2.type_desc,r1.name,r2.value,r1.description,
		r2.sec_type,r2.value_1,r2.value_2,r2.value_3,r2.value_4,r1.sort
	</sql>
	<sql id="queryManyAllFieldsTwo">
		r1.id
		rid,r1.gmt_create,r1.gmt_modified,r1.creator,r1.modifier,r1.data_type,r1.type,r1.type_desc,r1.name,r1.value,r1.description,
		r1.sec_type,r1.value_1,r1.value_2,r1.value_3,r1.value_4,r1.sort
	</sql>
	<select id="selectHomeConfigByAllTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		type in
		('HOME_BANNER','HOME_TOOLS','HOME_COUPON','HOME_ONE_TO_MANY','HOME_ONE_TO_TWO','HOME_ONE_TO_ONE')
	</select>


	<select id="getConfigByTypeList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM af_resource
		WHERE
		is_delete = 0 AND type IN
		<foreach collection="typeList" item="item" open="(" close=")"
			separator=",">
			#{item}
		</foreach>
	</select>


	<select id="getConfigByTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		type = #{type}
	</select>
	<select id="getConfigByTypesAndSecType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = #{secType}
		LIMIT 1

	</select>
	<select id="getResourceByResourceId" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND id = #{rid}
		LIMIT 1

	</select>
 <select id="getOpenBoluomeCouponById"  resultType="AfResourceDo">
		SELECT
			<include refid="queryAllFields" />
			FROM af_resource 
			WHERE is_delete = 0
			AND  value_4 = 'O'
			AND value_2 > NOW() 
			AND id = #{rid}
			LIMIT 1
	</select>


	<select id="getResourceListByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type} AND is_delete = 0
	</select>

	<select id="getResourceListByTypeOrderBy" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type} AND value_4 = 'O' AND is_delete = 0
		order by sort desc
	</select>

	<select id="getResourceHomeListByTypeOrderBy" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND value_4 = 'O'
		AND is_delete = 0
		order by
		sort desc
	</select>
	
	<select id="getResourceHomeListByTypeOrderByOnPreEnv" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		order by
		sort desc
	</select>

	<select id="getSingleResourceBytype" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		LIMIT 1
	</select>
	
	<select id="getLaunchImageInfoByTypeAndVersion" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		AND value = 'PART'
		AND   #{version} >= value_1
		AND value_2 >= #{version}
		AND value_4 = 'O'
		order by gmt_create desc
		LIMIT 1
	</select>
	
	<select id="getLaunchImageInfoByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		AND value = 'ALL'
		AND value_4 = 'O'
		order by gmt_create desc
		LIMIT 1
	</select>

	<select id="getHomeIndexListByOrderby" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND is_delete = 0
		order by
		sort
	</select>

	<select id="getOneToManyResourceOrderByBytype" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsOneTwo" />
		FROM
		af_resource r1 LEFT JOIN af_resource r2
		ON r1.id = r2.value_4
		WHERE
		r1.type = #{type}
		AND r1.sec_type = ''
		AND r2.value_4 !=''
		AND r1.is_delete =0
		AND r2.is_delete =0
		AND r1.value_4 = 'O'
		ORDER BY
		r1.sort ,r1.id , r2.sort
	</select>
	
	<select id="getOneToManyResourceOrderByBytypeOnPreEnv" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFields" />
		FROM
		af_resource r1 LEFT JOIN af_resource r2
		ON r1.id = r2.value_4
		WHERE
		r1.type = #{type}
		AND r1.sec_type = ''
		AND r2.value_4 !=''
		AND r1.is_delete =0
		AND r2.is_delete =0
	<!-- 	AND r1.value_4 = 'O' -->
		ORDER BY
		r1.sort ,r1.id , r2.sort
	</select>
	
	<select id="getCarouselToManyResourceOrderByType" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo" />
		FROM
		af_resource r1
		LEFT JOIN
		af_resource r2
		ON r1.value_4=r2.id
		where
		r1.type= #{type} and r2.value_4='O' and r2.type is not null and r1.is_delete=0
		ORDER BY
		r1.sort ,r1.id
	</select>

	<select id="getManyPricutresResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryManyAllFieldsTwo" />
		FROM
		af_resource r1
		LEFT JOIN
		af_resource r2
		ON r1.value_4=r2.id
		where
		r1.type= #{type} and r2.value_4='O' and r2.type is not null and r1.is_delete=0
		ORDER BY
		r1.sort ,r1.id
	</select>

	<select id="getNavigationUpOneResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND
		is_delete = 0
		AND value_4 = 'O'
		ORDER BY
		sort
	</select>

	<select id="getNavigationDownTwoResourceDoList" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		type = #{type}
		AND
		is_delete = 0
		AND value_4 = 'C'
		ORDER BY
		sort
	</select>
	
	<select id="selectBorrowHomeConfigByAllTypes" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND
		( (
		type ='BORROW_RATE'
		AND
		sec_type in
		('BASE_BANK_RATE','BORROW_CASH_RANGE','BORROW_CASH_BASE_BANK_DOUBLE','BORROW_CASH_POUNDAGE','BORROW_CASH_OVERDUE_POUNDAGE','BORROW_CASH_LENDER','BORROW_CASH_SUPUER_SWITCH','BORROW_CASH_TOTAL_SWITCH','BORROW_CASH_SHOW_NUM','BORROW_CASH_LENDER_FOR_CASH')
		)Or type ='BORROW_CASH_DAY')

	</select>

	<select id = "selectActivityConfig" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'ACTIVITY_SIGNIN'
		<![CDATA[
		AND  DATE_FORMAT(value_1,'%Y-%m-%d') <= DATE_FORMAT(NOW(),'%Y-%m-%d')
		AND DATE_FORMAT(value_2,'%Y-%m-%d') >= DATE_FORMAT(NOW(),'%Y-%m-%d')	
		]]>	
	</select>
	<select id = "getScrollbarByType" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'BORROW_TOP_SCROLLBAR'
		AND value_4 = 'O'
	</select>
	<select id = "getFakePersonByActivityId" resultType = "AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0
		AND type = 'GG_FAKE_PERSON'
		AND value = #{activityId}
	</select>
	<select id = "getGGSpecificBanner" resultType = "AfResourceDo">
		SELECT
			*
		FROM
			af_resource
		WHERE
			type = 'GG_TOP_BANNER'
		AND is_delete = 0
		AND value_4 ='O'
		AND value_2 = #{value2};
	</select>
	
	<select id="getActivieResourceByType" resultType = "AfResourceDo">
		select
		<include refid="queryAllFields" />
		from af_resource WHERE type = #{type} and is_delete = 0 ORDER BY sort asc
	</select>
	<select id="getConfigsByTypesAndSecType" resultType="AfResourceDo">
		SELECT
		<include refid="queryAllFields" />
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = #{secType}
		and value_4 ='O';
	</select>

	<select id="getBackGroundByType" resultType="AfResourceDo">
		SELECT
		name,value,value_1,value_3,sort
		FROM
		af_resource
		WHERE
		is_delete = 0 AND type = #{type} AND sec_type = '1'
	</select>
	
	<select id="getActivityRule" resultType="String">
		SELECT value from af_resource where is_delete = 0 and type =#{type}
	</select>
</mapper>
