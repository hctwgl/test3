<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- af_trade_withdraw_record表:商圈商户提现记录表模块 -->
<mapper namespace="com.ald.fanbei.api.dal.dao.AfTradeWithdrawRecordDao">

	<!--基本的sql查询字段 公共引用... -->
	<sql id="queryFields">
		id,gmt_create,gmt_modified,status,business_id,amount,type,card_number,card_name,card_code
	</sql>

	<!-- 基本的sql查询条件公共引用 -->
	<sql id="commonCondition">
		WHERE is_delete = 0
		<if test="id !=null">
			AND id = #{id,jdbcType=INTEGER}
		</if>
		<if test="gmtCreate !=null">
			AND gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}
		</if>
		<if test="gmtModified !=null">
			AND gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}
		</if>
		<if test="status != null and status != ''">
			AND status = #{status,jdbcType=VARCHAR}
		</if>
		<if test="businessId != null and businessId != ''">
			AND business_id = #{businessId,jdbcType=INTEGER}
		</if>
		<if test="amount != null and amount != ''">
			AND amount = #{amount,jdbcType=DECIMAL}
		</if>
		<if test="type != null and type != ''">
			AND type = #{type,jdbcType=VARCHAR}
		</if>
		<if test="cardNumber != null and cardNumber != ''">
			AND card_number = #{cardNumber,jdbcType=VARCHAR}
		</if>
		<if test="cardName != null and cardName != ''">
			AND card_name = #{cardName,jdbcType=VARCHAR}
		</if>
		<if test="cardCode != null and cardCode != ''">
			AND card_code = #{cardCode,jdbcType=VARCHAR}
		</if>
	</sql>


	<insert id="saveRecord"
		parameterType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo"
		keyProperty="id">
		<selectKey resultType="java.lang.Long" keyProperty="id"
			order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>

		INSERT INTO af_trade_withdraw_record
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="gmtCreate != null">
				gmt_create,
			</if>
			<if test="gmtModified != null">
				gmt_modified,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="businessId != null">
				business_id,
			</if>
			<if test="amount != null">
				amount,
			</if>
			<if test="type != null">
				type,
			</if>
			<if test="cardNumber != null">
				card_number,
			</if>
			<if test="cardName != null">
				card_name,
			</if>
			<if test="cardCode != null">
				card_code,
			</if>
		</trim>

		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="gmtCreate != null">
				#{gmtCreate,jdbcType=TIMESTAMP},
			</if>
			<if test="gmtModified != null">
				#{gmtModified,jdbcType=TIMESTAMP},
			</if>
			<if test="status != null">
				#{status,jdbcType=VARCHAR},
			</if>
			<if test="businessId != null">
				#{businessId,jdbcType=INTEGER},
			</if>
			<if test="amount != null">
				#{amount,jdbcType=DECIMAL},
			</if>
			<if test="type != null">
				#{type,jdbcType=VARCHAR},
			</if>
			<if test="cardNumber != null">
				#{cardNumber,jdbcType=VARCHAR},
			</if>
			<if test="cardName != null">
				#{cardName,jdbcType=VARCHAR},
			</if>
			<if test="cardCode != null">
				#{cardCode,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>

	<update id="updateById"
		parameterType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo">
		UPDATE af_trade_withdraw_record
		<set>
			<if test="gmtCreate != null and gmtCreate != '' ">
				gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
			</if>
			<if test="gmtModified != null and gmtModified != '' ">
				gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
			</if>
			<if test="status != null and status != '' ">
				status = #{status,jdbcType=VARCHAR},
			</if>
			<if test="businessId != null and businessId != '' ">
				business_id = #{businessId,jdbcType=INTEGER},
			</if>
			<if test="amount != null and amount != '' ">
				amount = #{amount,jdbcType=DECIMAL},
			</if>
			<if test="type != null and type != '' ">
				type = #{type,jdbcType=VARCHAR},
			</if>
			<if test="cardNumber != null and cardNumber != '' ">
				card_number = #{cardNumber,jdbcType=VARCHAR},
			</if>
			<if test="cardName != null and cardName != '' ">
				card_name = #{cardName,jdbcType=VARCHAR},
			</if>
			<if test="cardCode != null and cardCode != '' ">
				card_code = #{cardCode,jdbcType=VARCHAR}
			</if>
		</set>
		WHERE is_delete = 0 AND id = #{id ,jdbcType=BIGINT}
	</update>

	<select id="getById"
		resultType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo">
		SELECT
		<include refid="queryFields" />
		FROM af_trade_withdraw_record
		WHERE is_delete = 0 AND id=#{id
		,jdbcType=BIGINT}
		LIMIT 0,1
	</select>

	<select id="getByCommonCondition"
		resultType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo"
		parameterType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo">
		SELECT
		<include refid="queryFields" />
		FROM af_trade_withdraw_record
		<include refid="commonCondition" />
		limit 0,1
	</select>

	<select id="getListByCommonCondition"
		resultType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo"
		parameterType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo">
		SELECT
		<include refid="queryFields" />
		FROM af_trade_withdraw_record
		<include refid="commonCondition" />
	</select>

	<select id="withdrawGrid"
			resultType="com.ald.fanbei.api.dal.domain.AfTradeWithdrawRecordDo">
		select
		<include refid="queryFields" />
		from af_trade_withdraw_record
		where business_id = #{businessId}
		<if test="startDate != null and startDate != '' ">
			and gmt_create <![CDATA[   >=  ]]>
			#{startDate}
		</if>
		<if test="endDate != null and endDate != '' ">
			and gmt_create <![CDATA[   <=  ]]>
			#{endDate}
		</if>
		limit #{offset} , #{limit}
	</select>
	<select id="withdrawGridTotal" resultType="java.lang.Long">
		select
		count(id)
		from af_trade_withdraw_record
		where business_id = #{businessId}
		<if test="startDate != null and startDate != '' ">
			and gmt_create <![CDATA[   >=  ]]>
			#{startDate}
		</if>
		<if test="endDate != null and endDate != '' ">
			and gmt_create <![CDATA[   <=  ]]>
			#{endDate}
		</if>
	</select>
</mapper>
